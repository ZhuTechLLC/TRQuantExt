# 韬睿量化平台 - AI模型智能选择策略

## 📋 概述

基于开发经验，不同任务对AI模型能力要求不同。本文档提供模型选择指南，优化成本和效率。

---

## 🎯 模型能力分级

### 📌 默认模式: Auto Mode (Claude Sonnet) ⚡

**重要**: 从现在起，**默认使用 Auto Mode**。大部分任务都可以用Auto Mode完成。

**工作流程**:
1. 开始任务时，运行评估脚本: `python scripts/task_evaluator.py`
2. 如果评估建议用 **Auto Mode** → 直接继续开发
3. 如果评估建议用 **Max Mode** → 在Cursor中切换到Max Mode后再继续
4. 如果评估建议用 **Fast Mode** → 可以继续用Auto，或切换到Fast Mode

**⚠️ 注意**: 目前不支持自动切换模式，需要手动在Cursor中切换。

---

### Tier 1: Max Mode (Claude Opus 4.5) 🔥
**最强大，用于最复杂任务**

适用场景：
- 🏗️ **架构设计** - 系统级设计决策
- 📐 **算法开发** - 复杂评分模型、引擎设计
- 🔧 **疑难Bug修复** - 多文件关联的复杂问题
- 📝 **方案生成** - GPT深度研究级别的专业文档
- 🔄 **大规模重构** - 跨模块的代码重组
- 💡 **创新功能** - 从零开始的新功能设计

**何时使用**: 评估脚本评分 ≥8分，或明确提示需要Max Mode

### Tier 2: Auto Mode (Claude Sonnet) ⚡ (默认)
**平衡效率，用于大部分任务**

适用场景：
- 🔨 **功能实现** - 根据已有设计实现代码
- 🐛 **常规Bug修复** - 单文件或简单关联的问题
- 📄 **文档编写** - README、注释、使用说明
- 🧪 **测试编写** - 单元测试、集成测试
- 🎨 **UI调整** - 样式修改、布局优化
- 📊 **数据处理** - 数据格式转换、清洗

**何时使用**: 评估脚本评分 <8分，或默认情况

### Tier 3: Fast Mode (Claude Haiku) ⚡⚡
**最快速，用于简单任务**

**关于 Haiku**:
- Claude Haiku 是 Anthropic 最快的模型
- 在 Cursor 中，Fast Mode 可能使用 Haiku 或类似的轻量模型
- 适合简单、重复性任务

适用场景：
- ✏️ **小修改** - 改变量名、修复拼写
- 📋 **代码格式化** - 统一代码风格
- 🔍 **代码查询** - 查找函数、理解代码
- 💬 **简单问答** - 解释概念、回答问题
- 📁 **文件操作** - 移动、重命名、复制

**何时使用**: 评估脚本评分 <4分，且任务非常简单

---

## 📊 任务分类决策树

```
开始任务
    │
    ├─ 是否涉及系统架构？ ──是──→ 🔥 Max Mode (Opus 4.5)
    │
    ├─ 是否是新功能设计？ ──是──→ 🔥 Max Mode (Opus 4.5)
    │
    ├─ 是否涉及复杂算法？ ──是──→ 🔥 Max Mode (Opus 4.5)
    │
    ├─ 是否跨多个文件？
    │   ├─ 是且逻辑复杂 ──────→ 🔥 Max Mode (Opus 4.5)
    │   └─ 是但逻辑简单 ──────→ ⚡ Auto Mode (Sonnet)
    │
    ├─ 是否是已有功能的实现？ ─→ ⚡ Auto Mode (Sonnet)
    │
    ├─ 是否是文档/测试？ ─────→ ⚡ Auto Mode (Sonnet)
    │
    └─ 是否是简单修改？ ──────→ ⚡⚡ Fast Mode (Haiku)
```

---

## 🏷️ 任务标签系统

在开始任务时，使用以下标签帮助选择模型：

### 需要 Max Mode 的标签
```
#架构设计 #算法开发 #疑难Bug #方案生成 #大规模重构 #创新功能
#复杂逻辑 #多模块关联 #性能优化 #安全相关
```

### 可用 Auto Mode 的标签
```
#功能实现 #常规Bug #文档编写 #测试编写 #UI调整 #数据处理
#代码补全 #接口对接 #配置修改
```

### 可用 Fast Mode 的标签
```
#小修改 #格式化 #代码查询 #简单问答 #文件操作
#变量重命名 #注释添加
```

---

## 📋 韬睿量化具体任务分配

### 🔥 Max Mode 任务

| 任务 | 原因 |
|------|------|
| 热度评分引擎设计 | 需要设计评分算法和轮动信号逻辑 |
| 个股筛选模型 | 多维度评分模型，复杂算法 |
| 回测引擎集成 | 跨平台(PTrade/QMT)架构设计 |
| 实时监控系统 | 事件驱动架构，预警逻辑 |
| 多市场架构 | 抽象设计，模块化分离 |

### ⚡ Auto Mode 任务

| 任务 | 原因 |
|------|------|
| GUI面板实现 | 按已有模式实现 |
| 报告生成器 | 模板化开发 |
| 数据获取器扩展 | 添加新API调用 |
| 文档更新 | 记录和说明 |
| 测试用例编写 | 按功能编写测试 |
| 样式调整 | UI美化 |

### ⚡⚡ Fast Mode 任务

| 任务 | 原因 |
|------|------|
| 修复拼写错误 | 简单文本修改 |
| 调整颜色值 | 单行修改 |
| 添加日志语句 | 简单代码插入 |
| 查询代码位置 | 搜索和定位 |

---

## 🤖 智能提醒模板

### 开始新任务时的自检清单

```markdown
## 任务评估

**任务描述**: [描述任务]

**复杂度检查**:
- [ ] 是否涉及系统架构设计？
- [ ] 是否需要设计新算法？
- [ ] 是否跨越多个模块？
- [ ] 是否有复杂的业务逻辑？
- [ ] 是否是疑难问题？

**推荐模型**:
- 勾选3项以上 → 🔥 Max Mode (Opus 4.5)
- 勾选1-2项 → ⚡ Auto Mode (Sonnet)
- 全部未勾选 → ⚡⚡ Fast Mode (Haiku)
```

---

## 🚀 使用流程

### 标准工作流程

```
开始新任务
    │
    ├─ 运行评估脚本
    │   python scripts/task_evaluator.py
    │
    ├─ 评估结果:
    │   ├─ 建议 Auto Mode (评分 <8)
    │   │   └─ ✅ 直接继续，使用默认的 Auto Mode
    │   │
    │   └─ 建议 Max Mode (评分 ≥8)
    │       └─ ⚠️  在 Cursor 中切换到 Max Mode
    │           然后继续开发
    │
    └─ 完成任务
```

### 快速决策

| 评估结果 | 操作 |
|----------|------|
| 评分 <4 | ✅ 直接用 Auto Mode |
| 评分 4-7 | ✅ 直接用 Auto Mode |
| 评分 ≥8 | ⚠️ 切换到 Max Mode |

### 注意事项

- ⚠️ **不支持自动切换**: 需要手动在 Cursor 中切换模式
- ✅ **默认 Auto Mode**: 大部分任务都可以用 Auto Mode
- 💡 **遇到困难时**: 如果 Auto Mode 无法解决，再升级到 Max Mode

---

## 💡 使用建议

### 1. 分阶段使用不同模型

```
阶段1: 方案设计 (Max Mode)
    └── GPT深度研究，架构设计
    
阶段2: 核心实现 (Max Mode)
    └── 算法开发，引擎编写
    
阶段3: 功能完善 (Auto Mode)
    └── GUI实现，报告生成
    
阶段4: 测试文档 (Auto Mode)
    └── 测试编写，文档更新
    
阶段5: 小修小补 (Fast Mode)
    └── 格式调整，拼写修复
```

### 2. 任务拆分策略

将大任务拆分为小任务，只在关键部分使用Max Mode：

```
大任务: 开发热度评分系统

拆分:
├── 评分算法设计 ────────→ 🔥 Max Mode (核心)
├── 数据获取器扩展 ───────→ ⚡ Auto Mode
├── GUI面板实现 ─────────→ ⚡ Auto Mode
├── 报告生成器 ──────────→ ⚡ Auto Mode
├── 文档编写 ───────────→ ⚡ Auto Mode
└── 样式微调 ───────────→ ⚡⚡ Fast Mode
```

### 3. 何时升级模型

如果Auto Mode遇到以下情况，升级到Max Mode：
- 多次尝试仍无法解决
- 问题涉及多个文件的复杂关联
- 需要理解深层业务逻辑
- 代码修改导致连锁问题

---

## 📊 成本效益分析

| 模型 | 相对成本 | 适用占比 | 效果 |
|------|----------|----------|------|
| Max Mode | 高 | 20-30% | 关键决策 |
| Auto Mode | 中 | 50-60% | 日常开发 |
| Fast Mode | 低 | 10-20% | 简单任务 |

**优化后预期**:
- 成本降低 40-50%
- 开发效率保持不变
- 关键质量有保障

---

## 🔄 持续优化

### 记录模型使用效果

每次任务完成后，记录：
1. 使用的模型
2. 任务类型
3. 完成效果
4. 是否需要升级/降级

### 定期回顾

每周回顾模型使用情况，调整策略。

---

*本策略持续优化，根据实际效果调整*

