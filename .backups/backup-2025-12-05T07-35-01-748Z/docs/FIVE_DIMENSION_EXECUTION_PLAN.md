# 五维评分系统重构 - 完整执行方案

## 📄 PDF设计方案核心要点

### 五个维度Tab设计

#### 1. 💰 资金维度 Tab (30%权重)
**评分逻辑**：
- 主力资金净流入额及连续流入天数（高权重）
- 大单成交占比（机构资金介入）
- 融资融券余额变化（杠杆资金态度）
- 时间衰减（指数衰减，昨日>一周前）
- 可选：北向资金流、成交额占比、换手率突变

**功能栏**：
- 时间窗口选择（近5日、20日、60日）
- 按资金得分或净流入金额排序
- 筛选器（行业类型、总市值规模）
- 一键切换不同日期/周期
- 累计资金曲线图表

**可视化**：
- 柱状图（资金净流入得分）
- 折线图（资金流随时间变化）
- 热力表（按资金流强度着色）

---

#### 2. 🔥 热度维度 Tab (20%权重)
**评分逻辑**：
- 板块热度指数（帖子/新闻提及量激增）
- 涨停股数量及连板高度
- 情绪指标（涨停封板率、炸板率）
- 7日滑窗衰减
- 可选：百度搜索指数、交易用户数变化、机构研报关注度

**功能栏**：
- 舆情时间窗选择（1日内、7日内）
- 按热度得分或涨停家数排序
- 筛选器（情绪状态、社交媒体来源）
- 指标说明按钮
- 刷新功能（实时抓取最新舆情）

**可视化**：
- 热力图/热力表（按热度值着色）
- 折线趋势图（舆情指数随时间变化）
- 堆叠柱状图（不同来源热度占比）
- 雷达图（热度子因子评分比例）

---

#### 3. 📈 动量维度 Tab (20%权重)
**评分逻辑**：
- 价格动量（近5日/10日累计涨幅）
- 相对强度（相对大盘超额收益）
- 成交量动量（量比、成交额突增）
- 技术信号（突破均线、阶段新高）
- 时间衰减 + 持续性加分
- 可选：波动率指标、资金趋势配合度

**功能栏**：
- 动量周期选择（3日/5日/1月）
- 按动量得分或累计涨幅排序
- 筛选器（排除波动过大、趋势走弱）
- 切换基准功能（沪深300等）
- 技术指标开关（MACD金叉等）

**可视化**：
- 趋势折线图（价格走势和涨跌幅）
- 柱状图（动量得分或阶段涨幅）
- 迷你趋势图（Sparkline）
- 雷达图（动量子指标得分分布）

---

#### 4. 📜 政策维度 Tab (15%权重)
**评分逻辑**：
- 政策强度（政策级别：国家级>地方）
- 政策频度（一段时间内政策出现频率）
- 事件影响（行业大会、产业规划）
- 时效衰减（新近政策权重更高）
- 长期战略加分（五年规划等）
- 可选：监管态度、国际政策环境

**功能栏**：
- 政策观察期选择（近1月/近半年）
- 按政策得分排序
- 筛选器（仅显示国家政策支撑）
- 政策列表下拉（政策文件列表和摘要）
- 关键词搜索框

**可视化**：
- 列表+图标（政策事件图标或等级标识）
- 时间轴图（政策事件对得分的影响）
- 热力矩阵（主线×政策类别）

---

#### 5. 👑 龙头维度 Tab (15%权重)
**评分逻辑**：
- 龙头股高度（连续涨停天数、累计涨幅）
- 梯队结构（一进二板、二进三板接力）
- 市值龙头影响力（市值和成交占比）
- 快速衰减（连续板高度一周内有效）
- 可选：板块集中度指标

**功能栏**：
- 龙头监测周期选择
- 按龙头维度得分排序
- 筛选器（超强龙头出现的题材）
- 代表个股显示（侧边栏）
- 对比开关（对比两个主线的龙头结构）

**可视化**：
- 柱状图（龙头高度比较）
- 图标提示（五连板等标记）
- 雷达图/蜘蛛网图（龙头股与板块对比）
- 瀑布图（龙头接力情况）

---

### 综合Tab：专业投资主线

**综合评分机制**：
- 资金30% + 热度20% + 动量20% + 政策15% + 龙头15%
- 支持动态权重策略（根据市场环境调整）
- Min-Max归一化或Z-score标准化
- 维度分数低于阈值时限制总评分

**输出结构**：
- 列表视图（主线名称、五维得分、综合得分、行业标签）
- 热力分组（按行业归类）
- 雷达图概览（多主线对比）
- 详情入口

**多周期切换**：
- 短期3-5日、中期15-30日、长期60-180日
- 主线轨迹回顾（日期选择器）
- 回溯ID和测试链接

---

## 🎯 任务分解与模型选择

### 阶段1：核心引擎开发 🔥 **Max Mode**

#### 任务1.1：创建五维评分引擎
- **文件**：`markets/ashare/mainline/five_dimension_engine.py`
- **复杂度**：**高**
- **推荐模型**：**Max Mode**
- **功能**：
  - 实现5个维度的独立计算逻辑
  - 时间衰减算法
  - 综合评分计算
  - 动态权重支持

#### 任务1.2：创建维度数据获取器
- **文件**：`markets/ashare/mainline/dimension_data_fetcher.py`
- **复杂度**：中
- **推荐模型**：**Auto Mode**
- **功能**：为每个维度优化数据获取

---

### 阶段2：UI组件开发 🔥 **Max Mode**

#### 任务2.1-2.5：创建5个维度Tab
- **复杂度**：**高**（每个Tab）
- **推荐模型**：**Max Mode**
- **文件**：
  - `gui/widgets/dimension_tabs/funds_dimension_tab.py`
  - `gui/widgets/dimension_tabs/momentum_dimension_tab.py`
  - `gui/widgets/dimension_tabs/heat_dimension_tab.py`
  - `gui/widgets/dimension_tabs/policy_dimension_tab.py`
  - `gui/widgets/dimension_tabs/leader_dimension_tab.py`

#### 任务2.6：创建综合评分Tab
- **文件**：`gui/widgets/professional_mainline_tab.py`
- **复杂度**：**高**
- **推荐模型**：**Max Mode**
- **功能**：雷达图、多周期切换、轨迹回顾

---

### 阶段3：主面板集成 🔥 **Max Mode**

#### 任务3.1：重构主面板Tab结构
- **文件**：`gui/widgets/mainline_panel.py`
- **复杂度**：**高**
- **推荐模型**：**Max Mode**
- **修改**：将"专业主线识别"改为Tab容器，包含6个子Tab

---

### 阶段4：数据存储 🔥 **Max Mode**

#### 任务4.1：MongoDB数据结构实现
- **文件**：`markets/ashare/mainline/five_dimension_storage.py`
- **复杂度**：**高**
- **推荐模型**：**Max Mode**
- **集合**：
  - `theme_dimension_scores`（主线维度评分）
  - `stock_dimension_scores`（个股维度评分）
  - `mainline_results`（主线识别结果）
- **索引**：date, theme_id, period等

---

### 阶段5：个股联动 🔥 **Max Mode**

#### 任务5.1：主线-个股联动功能
- **复杂度**：**高**
- **推荐模型**：**Max Mode**
- **功能**：
  - 主线页联动代表个股（侧边栏）
  - 个股详情页的主线关联
  - 个股筛选Tab（按维度条件筛选）

---

## 📊 执行优先级

### 立即执行（Max Mode）

1. **五维评分引擎** - 核心算法
2. **5个维度Tab组件** - 核心UI
3. **综合评分Tab** - 汇总展示
4. **主面板集成** - 整体架构

### 后续执行（Max Mode）

5. **MongoDB存储** - 数据持久化
6. **个股联动** - 增强功能

---

## ⏱️ 预计时间

- **Max Mode任务**：约25小时
- **Auto Mode任务**：约5小时
- **总计**：约30小时

---

## 🚀 开始执行

**建议**：切换到 **Max Mode** 后，按优先级顺序执行。

*基于《市场主线识别模块五维评分系统设计方案.pdf》*

