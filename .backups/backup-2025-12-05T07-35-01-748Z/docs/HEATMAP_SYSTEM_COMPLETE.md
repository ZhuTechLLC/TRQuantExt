# çƒ­åº¦è¯„åˆ†ç³»ç»Ÿå¼€å‘å®Œæˆæ€»ç»“

## âœ… å¼€å‘çŠ¶æ€ï¼šå·²å®Œæˆ

**å®Œæˆæ—¶é—´**: 2024å¹´11æœˆ28æ—¥  
**åŸºäºæ–‡æ¡£**: ã€Šå¸‚åœºä¸»çº¿è¯†åˆ«æ¨¡å—ä¹‹çƒ­åº¦è¯„åˆ†è®¾è®¡æ–¹æ¡ˆ.pdfã€‹

---

## ğŸ“Š ç³»ç»Ÿæ¶æ„

### æ ¸å¿ƒæ¨¡å—

```
markets/ashare/mainline/
â”œâ”€â”€ heatmap_engine.py           # ä¸»çº¿çƒ­åº¦è¯„åˆ†å¼•æ“ (7å› å­)
â”œâ”€â”€ stock_heatmap_engine.py     # ä¸ªè‚¡çƒ­åº¦è¯„åˆ†å¼•æ“ (8å› å­)
â”œâ”€â”€ heatmap_report_generator.py # çƒ­åº¦æŠ¥å‘Šç”Ÿæˆå™¨
â”œâ”€â”€ pro_engine.py               # å¢å¼ºç‰ˆä¸»çº¿è¯†åˆ«å¼•æ“ (é›†æˆçƒ­åº¦è¯„åˆ†)
â””â”€â”€ real_data_fetcher.py        # æ•°æ®è·å–å™¨

gui/widgets/
â”œâ”€â”€ heatmap_panel.py            # çƒ­åº¦è¯„åˆ†GUIé¢æ¿
â””â”€â”€ mainline_panel.py           # ä¸»çº¿é¢æ¿ (é›†æˆçƒ­åº¦Tab)
```

---

## ğŸ”¥ ä¸»çº¿çƒ­åº¦è¯„åˆ† (7å› å­)

| å› å­ | æƒé‡ | è¯´æ˜ |
|------|------|------|
| æ–°é—»æ•°é‡ | 20% | åª’ä½“æ›å…‰åº¦ |
| å…³é”®è¯æåŠ | 10% | å¸‚åœºèˆ†è®ºçƒ­åº¦ |
| æœç´¢æŒ‡æ•° | 10% | å¤§ä¼—å…³æ³¨åº¦ |
| ç ”æŠ¥è¦†ç›–åº¦ | 15% | æœºæ„å…³æ³¨åº¦ |
| ç¤¾äº¤ä¼ æ’­åº¦ | 15% | æ•£æˆ·æƒ…ç»ªçƒ­åº¦ |
| é¾™è™æ¦œæ¬¡æ•° | 15% | æ¸¸èµ„åŠ¨å‘ |
| æ¶¨åœè‚¡æ•°é‡ | 15% | æ¿å—çˆ†ç‚’ç¨‹åº¦ |

### æ ‡å‡†åŒ–æ–¹æ³•
- **Min-Maxå½’ä¸€åŒ–**: è®¡æ•°ç±»å› å­
- **å¯¹æ•°ç¼©æ”¾**: åˆ†å¸ƒåæ€å› å­
- **Z-Scoreæ ‡å‡†åŒ–**: ä¸å†å²å‡å€¼æ¯”è¾ƒ
- **æŒ‡æ•°æ—¶é—´è¡°å‡**: çªå‡ºè¿‘æœŸä¿¡æ¯

---

## ğŸ¯ ä¸ªè‚¡çƒ­åº¦è¯„åˆ† (8å› å­)

| å› å­ | æƒé‡ | è¯´æ˜ |
|------|------|------|
| ä¸»çº¿çƒ­åº¦ | 15% | æ‰€å±ä¸»é¢˜çƒ­åº¦è¯„åˆ† |
| å…¬å¸æ–°é—»æ•° | 15% | åª’ä½“æ›å…‰åº¦ |
| é¾™è™æ¦œæ¬¡æ•° | 15% | æ¸¸èµ„å…³æ³¨åº¦ |
| æ¶¨åœæ¬¡æ•° | 15% | èµ„é‡‘è¿½æ§åº¦ |
| çƒ­ç‚¹æ¦‚å¿µé‡åˆåº¦ | 10% | é¢˜æå åŠ æ•ˆåº” |
| æ¿å—çƒ­åº¦å æ¯” | 10% | æ¿å—é¢†å†›æ€§ |
| è‚¡å§/é›ªçƒæåŠæ•° | 10% | æ•£æˆ·è®¨è®ºçƒ­åº¦ |
| ä¼°å€¼æå‡çƒ­åº¦ | 10% | ç‚’ä½œæº¢ä»·åº¦ |

### ç­–ç•¥åº”ç”¨
- **ä¸»çº¿å†…éƒ¨ç²¾é€‰ç­–ç•¥**: ä»ä¸»çº¿ä¸­é€‰çƒ­åº¦æœ€é«˜çš„é¾™å¤´è‚¡
- **çŸ­çº¿è½®åŠ¨ç­–ç•¥**: æ¯æ—¥è¿½é€çƒ­åº¦æœ€é«˜çš„ä¸ªè‚¡
- **äº‹ä»¶é©±åŠ¨ç­–ç•¥**: ç›‘æ§çƒ­åº¦çªç„¶é£™å‡çš„ä¸ªè‚¡
- **é£é™©ç›‘æ§ä¸æ­¢ç›ˆ**: çƒ­åº¦ä¸‹é™æ—¶åŠæ—¶ç¦»åœº

---

## ğŸ“ˆ çŸ­ä¸­é•¿æœŸä¸»çº¿åˆ†ç±»

### åˆ†ç±»è§„åˆ™

| å‘¨æœŸ | æ—¶é—´èŒƒå›´ | ç‰¹å¾ | ç­–ç•¥ |
|------|----------|------|------|
| çŸ­æœŸ | 3-5æ—¥ | äº‹ä»¶é©±åŠ¨ã€ä¸»é¢˜ç‚’ä½œ | çŸ­çº¿äº¤æ˜“ï¼Œå¿«è¿›å¿«å‡º |
| ä¸­æœŸ | 15-30æ—¥ | æ”¿ç­–å‚¬åŒ–ã€åŸºæœ¬é¢æ”¹å–„ | æ³¢æ®µæ“ä½œï¼Œè¶‹åŠ¿è·Ÿéš |
| é•¿æœŸ | 60-180æ—¥ | äº§ä¸šè¶‹åŠ¿ã€ç»æµç»“æ„ | ä»·å€¼æŠ•èµ„ï¼Œé•¿æœŸæŒæœ‰ |

### æƒé‡è°ƒæ•´

| å› å­ | çŸ­æœŸ | ä¸­æœŸ | é•¿æœŸ |
|------|------|------|------|
| ç¤¾äº¤åª’ä½“ | 20% | 15% | 10% |
| é¾™è™æ¦œ | 20% | 15% | 10% |
| æ¶¨åœæ•° | 20% | 10% | 5% |
| ç ”æŠ¥è¦†ç›– | 10% | 20% | 25% |
| æ–°é—»æ•°é‡ | 15% | 20% | 25% |

---

## ğŸ–¥ï¸ GUIåŠŸèƒ½

### çƒ­åº¦è¯„åˆ†é¢æ¿
- **æ–¹æ³•è®ºè¯´æ˜**: 7å› å­æƒé‡å’Œè®¡ç®—æ–¹æ³•
- **æ—¶é—´å‘¨æœŸé€‰æ‹©**: çŸ­æœŸ/ä¸­æœŸ/é•¿æœŸ
- **çƒ­åº¦æ’åè¡¨**: å®æ—¶æ˜¾ç¤ºä¸»çº¿çƒ­åº¦æ’å
- **å› å­æ‹†è§£è§†å›¾**: é€‰ä¸­ä¸»çº¿åæ˜¾ç¤ºå„å› å­å¾—åˆ†
- **è½®åŠ¨ä¿¡å·**: è‡ªåŠ¨è¯†åˆ«é«˜çƒ­åº¦å’Œä¸Šå‡è¶‹åŠ¿ä¸»çº¿

### å¼‚æ­¥æ•°æ®è·å–
- ä½¿ç”¨QThreadé˜²æ­¢UIé˜»å¡
- è¿›åº¦æ¡æ˜¾ç¤ºè·å–çŠ¶æ€
- é”™è¯¯å¤„ç†å’Œç¼“å­˜å›é€€

---

## ğŸ“ æŠ¥å‘Šç”Ÿæˆ

### HTMLæŠ¥å‘Šå†…å®¹
1. ç»Ÿè®¡æ¦‚è§ˆï¼ˆä¸»çº¿æ•°é‡ã€é«˜çƒ­åº¦æ•°é‡ç­‰ï¼‰
2. æ–¹æ³•è®ºè¯´æ˜ï¼ˆ7å› å­ä»‹ç»ï¼‰
3. çƒ­åº¦åˆ†å¸ƒåˆ†æ
4. ä¸»çº¿çƒ­åº¦æ’å Top 20
5. ä¸ªè‚¡çƒ­åº¦æ’å Top 30ï¼ˆå¯é€‰ï¼‰

### æŠ¥å‘Šå­˜å‚¨
```
~/.local/share/jqquant/reports/heatmap/
â””â”€â”€ heatmap_report_YYYYMMDD_HHMMSS.html
```

---

## ğŸ”§ å¢å¼ºç‰ˆä¸»çº¿è¯†åˆ«å¼•æ“

### æ–°æƒé‡é…ç½®
- **çƒ­åº¦ç»´åº¦**: 30% (åŸºäº7å› å­çƒ­åº¦è¯„åˆ†)
- **èµ„é‡‘ç»´åº¦**: 25%
- **è¶‹åŠ¿ç»´åº¦**: 25% (åŠ¨é‡+é¾™å¤´)
- **æ”¿ç­–ç»´åº¦**: 20%

### ä½¿ç”¨æ–¹å¼
```python
from markets.ashare.mainline.pro_engine import EnhancedMainlineEngine

engine = EnhancedMainlineEngine()
results = engine.analyze_enhanced(data)
```

---

## ğŸ“š APIå‚è€ƒ

### HeatmapEngine
```python
from markets.ashare.mainline.heatmap_engine import HeatmapEngine

engine = HeatmapEngine()
scores = engine.calculate_heatmap_scores(mainlines_data, period_type="short")
```

### StockHeatmapEngine
```python
from markets.ashare.mainline.stock_heatmap_engine import StockHeatmapEngine

engine = StockHeatmapEngine()
engine.set_mainline_heatmap({"äººå·¥æ™ºèƒ½": 85, "åŠå¯¼ä½“": 75})
scores = engine.calculate_stock_scores(stocks_data)
```

### MultiPeriodMainlineClassifier
```python
from markets.ashare.mainline.heatmap_engine import MultiPeriodMainlineClassifier

classifier = MultiPeriodMainlineClassifier()
ranking = classifier.get_comprehensive_ranking(mainlines_data)
```

### HeatmapReportGenerator
```python
from markets.ashare.mainline.heatmap_report_generator import HeatmapReportGenerator

generator = HeatmapReportGenerator()
report_path = generator.generate_html_report(mainline_scores)
```

---

## ğŸš€ ä¸‹ä¸€æ­¥è®¡åˆ’

1. **æ¥å…¥çœŸå®æ•°æ®æº**
   - æ–°é—»APIï¼ˆè´¢è”ç¤¾ã€ä¸œæ–¹è´¢å¯Œç­‰ï¼‰
   - æœç´¢æŒ‡æ•°APIï¼ˆç™¾åº¦æŒ‡æ•°ï¼‰
   - ç ”æŠ¥æ•°æ®åº“
   - ç¤¾äº¤åª’ä½“APIï¼ˆå¾®åšã€è‚¡å§ï¼‰

2. **å¢å¼ºåŠŸèƒ½**
   - çƒ­åº¦è¶‹åŠ¿å›¾è¡¨ï¼ˆå†å²èµ°åŠ¿ï¼‰
   - è½®åŠ¨é¢„è­¦é€šçŸ¥
   - ä¸€é”®å›æµ‹é“¾æ¥
   - è‡ªå®šä¹‰æƒé‡é¢æ¿

3. **ä¸å…¶ä»–æ¨¡å—é›†æˆ**
   - ä¸ªè‚¡ç­›é€‰å·¥å…·
   - å®æ—¶ç›‘æ§é¢æ¿
   - å›æµ‹ç³»ç»Ÿ

---

*éŸ¬ç¿é‡åŒ–å¹³å° - çƒ­åº¦è¯„åˆ†ç³»ç»Ÿ v1.0*

