---
/**
 * OpenBBå¢å¼ºç‰ˆæŠ•èµ„ä»ªè¡¨æ¿
 * é›†æˆOpenBBå¹³å°çš„æ ¸å¿ƒåŠŸèƒ½
 */
import Layout from '../layouts/Layout.astro';

// APIé…ç½®
const FINNHUB_API_KEY = 'd40eokhr01qqo3qhl4h0d40eokhr01qqo3qhl4hg';
const OPENBB_KEYS = {
  fmp: 'your_fmp_key',
  benzinga: 'your_benzinga_key',
  intrinio: 'your_intrinio_key'
};
---

<Layout title="OpenBBå¢å¼ºç‰ˆæŠ•èµ„ä»ªè¡¨æ¿">
  <style>
    /* å…¨å±€æ ·å¼ */
    :root {
      --primary-gradient: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      --success-gradient: linear-gradient(135deg, #0ba360 0%, #3cba92 100%);
      --warning-gradient: linear-gradient(135deg, #f2994a 0%, #f2c94c 100%);
      --danger-gradient: linear-gradient(135deg, #eb3349 0%, #f45c43 100%);
      --info-gradient: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
      --openbb-gradient: linear-gradient(135deg, #00d4aa 0%, #00a8cc 100%);
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
      color: #2d3748;
    }

    /* ä¸»å®¹å™¨ */
    .dashboard-container {
      max-width: 1800px;
      margin: 0 auto;
      padding: 20px;
    }

    /* é¡µé¢å¤´éƒ¨ */
    .page-header {
      background: white;
      border-radius: 20px;
      padding: 40px;
      margin-bottom: 30px;
      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.15);
      text-align: center;
      position: relative;
      overflow: hidden;
    }

    .page-header::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 4px;
      background: var(--openbb-gradient);
    }

    .page-header h1 {
      font-size: 3.5em;
      background: var(--openbb-gradient);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      margin-bottom: 15px;
    }

    .page-subtitle {
      font-size: 1.3em;
      color: #718096;
      margin-bottom: 25px;
    }

    .openbb-badge {
      display: inline-block;
      background: var(--openbb-gradient);
      color: white;
      padding: 8px 16px;
      border-radius: 20px;
      font-size: 0.9em;
      font-weight: 600;
      margin-bottom: 20px;
    }

    /* æ§åˆ¶é¢æ¿ */
    .control-panel {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 15px;
      margin-top: 25px;
    }

    .control-btn {
      padding: 15px 25px;
      border: none;
      border-radius: 12px;
      font-size: 1em;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 10px;
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
    }

    .control-btn:hover {
      transform: translateY(-3px);
      box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
    }

    .btn-primary {
      background: var(--primary-gradient);
      color: white;
    }

    .btn-success {
      background: var(--success-gradient);
      color: white;
    }

    .btn-warning {
      background: var(--warning-gradient);
      color: white;
    }

    .btn-info {
      background: var(--info-gradient);
      color: white;
    }

    .btn-openbb {
      background: var(--openbb-gradient);
      color: white;
    }

    /* æ•°æ®æºé€‰æ‹©å™¨ */
    .data-source-selector {
      background: white;
      border-radius: 15px;
      padding: 25px;
      margin-bottom: 30px;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
    }

    .data-source-selector h3 {
      font-size: 1.5em;
      color: #2d3748;
      margin-bottom: 20px;
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .source-options {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
      gap: 15px;
    }

    .source-btn {
      padding: 12px 20px;
      border: 2px solid #e2e8f0;
      border-radius: 10px;
      background: white;
      color: #718096;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      text-align: center;
    }

    .source-btn:hover {
      border-color: #667eea;
      color: #667eea;
    }

    .source-btn.active {
      border-color: #00d4aa;
      background: #00d4aa;
      color: white;
    }

    /* ä»ªè¡¨æ¿ç½‘æ ¼ */
    .dashboard-grid {
      display: grid;
      grid-template-columns: 2fr 1fr;
      gap: 30px;
      margin-bottom: 30px;
    }

    .dashboard-panel {
      background: white;
      border-radius: 20px;
      padding: 30px;
      box-shadow: 0 15px 40px rgba(0, 0, 0, 0.1);
      transition: transform 0.3s ease;
    }

    .dashboard-panel:hover {
      transform: translateY(-5px);
    }

    .panel-header {
      display: flex;
      align-items: center;
      gap: 15px;
      margin-bottom: 25px;
      padding-bottom: 15px;
      border-bottom: 2px solid #e2e8f0;
    }

    .panel-icon {
      font-size: 2.5em;
      width: 60px;
      height: 60px;
      display: flex;
      align-items: center;
      justify-content: center;
      border-radius: 15px;
      background: var(--openbb-gradient);
    }

    .panel-title {
      font-size: 1.8em;
      font-weight: 700;
      color: #2d3748;
    }

    .panel-subtitle {
      font-size: 1em;
      color: #718096;
      margin-top: 5px;
    }

    /* æ–°é—»é¢æ¿ */
    .news-panel {
      max-height: 600px;
      overflow-y: auto;
    }

    .news-filters {
      display: flex;
      gap: 15px;
      margin-bottom: 20px;
      flex-wrap: wrap;
    }

    .news-filters select,
    .news-filters input {
      padding: 10px 15px;
      border: 2px solid #e2e8f0;
      border-radius: 8px;
      font-size: 1em;
    }

    .news-filters select:focus,
    .news-filters input:focus {
      outline: none;
      border-color: #00d4aa;
    }

    .news-item {
      background: #f8fafc;
      border-radius: 12px;
      padding: 20px;
      margin-bottom: 15px;
      border-left: 4px solid #00d4aa;
      transition: all 0.3s ease;
      cursor: pointer;
    }

    .news-item:hover {
      background: #e6f7ff;
      transform: translateX(5px);
    }

    .news-item.positive {
      border-left-color: #0ba360;
      background: #f0f9f4;
    }

    .news-item.negative {
      border-left-color: #eb3349;
      background: #fef2f2;
    }

    .news-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 10px;
    }

    .news-title {
      font-size: 1.1em;
      font-weight: 600;
      color: #2d3748;
      flex: 1;
    }

    .news-source {
      font-size: 0.9em;
      color: #00d4aa;
      font-weight: 600;
      background: #e6f7ff;
      padding: 4px 8px;
      border-radius: 4px;
    }

    .news-content {
      font-size: 0.95em;
      color: #718096;
      line-height: 1.5;
      margin-bottom: 12px;
    }

    .news-meta {
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .news-date {
      font-size: 0.85em;
      color: #a0aec0;
    }

    .sentiment-badge {
      padding: 4px 8px;
      border-radius: 4px;
      font-size: 0.8em;
      font-weight: 600;
    }

    .sentiment-badge.positive {
      background: #f0f9f4;
      color: #0ba360;
    }

    .sentiment-badge.negative {
      background: #fef2f2;
      color: #eb3349;
    }

    .sentiment-badge.neutral {
      background: #f7fafc;
      color: #a0aec0;
    }

    /* å¸‚åœºæ•°æ®é¢æ¿ */
    .market-panel {
      display: flex;
      flex-direction: column;
      gap: 20px;
    }

    .symbol-input {
      display: flex;
      gap: 10px;
      margin-bottom: 20px;
    }

    .symbol-input input {
      flex: 1;
      padding: 12px 15px;
      border: 2px solid #e2e8f0;
      border-radius: 8px;
      font-size: 1em;
    }

    .symbol-input input:focus {
      outline: none;
      border-color: #00d4aa;
    }

    .quote-card {
      background: #f8fafc;
      border-radius: 12px;
      padding: 20px;
      text-align: center;
      border: 2px solid #e2e8f0;
    }

    .quote-symbol {
      font-size: 1.5em;
      font-weight: 700;
      color: #2d3748;
      margin-bottom: 10px;
    }

    .quote-price {
      font-size: 2.5em;
      font-weight: 700;
      color: #2d3748;
      margin-bottom: 10px;
    }

    .quote-change {
      font-size: 1.2em;
      font-weight: 600;
      padding: 8px 16px;
      border-radius: 8px;
    }

    .quote-change.positive {
      background: #f0f9f4;
      color: #0ba360;
    }

    .quote-change.negative {
      background: #fef2f2;
      color: #eb3349;
    }

    .quote-meta {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 10px;
      margin-top: 15px;
      font-size: 0.9em;
      color: #718096;
    }

    /* ç»Ÿè®¡é¢æ¿ */
    .stats-panel {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 20px;
      margin-bottom: 30px;
    }

    .stat-card {
      background: white;
      border-radius: 15px;
      padding: 25px;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
      display: flex;
      align-items: center;
      gap: 20px;
      transition: transform 0.3s ease;
    }

    .stat-card:hover {
      transform: translateY(-5px);
    }

    .stat-icon {
      font-size: 2.5em;
      width: 60px;
      height: 60px;
      display: flex;
      align-items: center;
      justify-content: center;
      border-radius: 15px;
      background: var(--openbb-gradient);
    }

    .stat-content h3 {
      font-size: 0.9em;
      color: #718096;
      margin-bottom: 8px;
    }

    .stat-number {
      font-size: 2em;
      font-weight: bold;
      color: #2d3748;
    }

    /* åŠ è½½çŠ¶æ€ */
    .loading {
      text-align: center;
      padding: 60px 20px;
      background: white;
      border-radius: 15px;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
    }

    .loading-spinner {
      width: 60px;
      height: 60px;
      border: 5px solid #f3f4f6;
      border-top: 5px solid #00d4aa;
      border-radius: 50%;
      animation: spin 1s linear infinite;
      margin: 0 auto 20px;
    }

    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }

    /* å“åº”å¼è®¾è®¡ */
    @media (max-width: 1200px) {
      .dashboard-grid {
        grid-template-columns: 1fr;
      }
    }

    @media (max-width: 768px) {
      .control-panel {
        grid-template-columns: 1fr;
      }

      .news-filters {
        flex-direction: column;
      }

      .source-options {
        grid-template-columns: repeat(2, 1fr);
      }
    }
  </style>

  <div class="dashboard-container">
    <!-- é¡µé¢å¤´éƒ¨ -->
    <header class="page-header">
      <div class="openbb-badge">Powered by OpenBB</div>
      <h1>ğŸš€ OpenBBå¢å¼ºç‰ˆæŠ•èµ„ä»ªè¡¨æ¿</h1>
      <p class="page-subtitle">å¤šæ•°æ®æº Â· å®æ—¶åˆ†æ Â· æ™ºèƒ½å†³ç­– Â· ä¼ä¸šçº§åŠŸèƒ½</p>
      
      <!-- æ§åˆ¶é¢æ¿ -->
      <div class="control-panel">
        <button class="control-btn btn-primary" id="btnRefresh">
          <span>ğŸ”„</span>
          <span>åˆ·æ–°æ•°æ®</span>
        </button>
        <button class="control-btn btn-success" id="btnAnalyze">
          <span>ğŸ§ </span>
          <span>æ™ºèƒ½åˆ†æ</span>
        </button>
        <button class="control-btn btn-warning" id="btnExport">
          <span>ğŸ“¤</span>
          <span>å¯¼å‡ºæ•°æ®</span>
        </button>
        <button class="control-btn btn-info" id="btnSettings">
          <span>âš™ï¸</span>
          <span>è®¾ç½®</span>
        </button>
        <button class="control-btn btn-openbb" id="btnOpenBB">
          <span>ğŸ”—</span>
          <span>OpenBBé›†æˆ</span>
        </button>
      </div>
    </header>

    <!-- æ•°æ®æºé€‰æ‹©å™¨ -->
    <div class="data-source-selector">
      <h3>ğŸ“Š æ•°æ®æºé€‰æ‹©</h3>
      <div class="source-options">
        <button class="source-btn active" data-source="fmp">FMP</button>
        <button class="source-btn" data-source="benzinga">Benzinga</button>
        <button class="source-btn" data-source="intrinio">Intrinio</button>
        <button class="source-btn" data-source="yfinance">Yahoo Finance</button>
        <button class="source-btn" data-source="finnhub">Finnhub</button>
      </div>
    </div>

    <!-- ç»Ÿè®¡é¢æ¿ -->
    <div class="stats-panel">
      <div class="stat-card">
        <div class="stat-icon">ğŸ“°</div>
        <div class="stat-content">
          <h3>æ–°é—»æ€»æ•°</h3>
          <div class="stat-number" id="totalNews">0</div>
        </div>
      </div>
      <div class="stat-card">
        <div class="stat-icon">ğŸ”—</div>
        <div class="stat-content">
          <h3>æ•°æ®æº</h3>
          <div class="stat-number" id="dataSources">0</div>
        </div>
      </div>
      <div class="stat-card">
        <div class="stat-icon">ğŸ“ˆ</div>
        <div class="stat-content">
          <h3>å¸‚åœºæ•°æ®</h3>
          <div class="stat-number" id="marketData">0</div>
        </div>
      </div>
      <div class="stat-card">
        <div class="stat-icon">ğŸ›ï¸</div>
        <div class="stat-content">
          <h3>ç»æµæŒ‡æ ‡</h3>
          <div class="stat-number" id="economyIndicators">0</div>
        </div>
      </div>
    </div>

    <!-- ä»ªè¡¨æ¿ç½‘æ ¼ -->
    <div class="dashboard-grid">
      <!-- æ–°é—»é¢æ¿ -->
      <div class="dashboard-panel">
        <div class="panel-header">
          <div class="panel-icon">ğŸ“°</div>
          <div>
            <div class="panel-title">å®æ—¶æ–°é—»</div>
            <div class="panel-subtitle">å¤šæºæ–°é—»èšåˆ Â· æ™ºèƒ½åˆ†æ Â· å®æ—¶æ›´æ–°</div>
          </div>
        </div>
        
        <!-- æ–°é—»ç­›é€‰å™¨ -->
        <div class="news-filters">
          <select id="newsProvider">
            <option value="fmp">FMP</option>
            <option value="benzinga">Benzinga</option>
            <option value="intrinio">Intrinio</option>
            <option value="finnhub">Finnhub</option>
          </select>
          <select id="newsCategory">
            <option value="general">ç»¼åˆæ–°é—»</option>
            <option value="AAPL">è‹¹æœå…¬å¸</option>
            <option value="TSLA">ç‰¹æ–¯æ‹‰</option>
            <option value="MSFT">å¾®è½¯</option>
            <option value="GOOGL">è°·æ­Œ</option>
          </select>
          <input type="text" id="newsSearch" placeholder="æœç´¢æ–°é—»...">
          <button class="control-btn btn-primary" id="btnRefreshNews">ğŸ”„ åˆ·æ–°</button>
        </div>

        <!-- æ–°é—»åˆ—è¡¨ -->
        <div class="news-panel" id="newsPanel">
          <div class="loading">
            <div class="loading-spinner"></div>
            <h3>æ­£åœ¨åŠ è½½æ–°é—»...</h3>
            <p>è¯·ç¨å€™</p>
          </div>
        </div>
      </div>

      <!-- å¸‚åœºæ•°æ®é¢æ¿ -->
      <div class="dashboard-panel">
        <div class="panel-header">
          <div class="panel-icon">ğŸ“ˆ</div>
          <div>
            <div class="panel-title">å¸‚åœºæ•°æ®</div>
            <div class="panel-subtitle">å®æ—¶æŠ¥ä»· Â· å†å²æ•°æ® Â· æŠ€æœ¯åˆ†æ</div>
          </div>
        </div>

        <!-- è‚¡ç¥¨æŸ¥è¯¢ -->
        <div class="symbol-input">
          <input type="text" id="symbolInput" placeholder="è¾“å…¥è‚¡ç¥¨ä»£ç  (å¦‚: AAPL)">
          <button class="control-btn btn-openbb" id="btnGetQuote">è·å–æŠ¥ä»·</button>
        </div>

        <!-- æŠ¥ä»·æ˜¾ç¤º -->
        <div id="quoteDisplay" class="quote-display">
          <div class="quote-card">
            <div class="quote-symbol">é€‰æ‹©è‚¡ç¥¨</div>
            <div class="quote-price">--</div>
            <div class="quote-change">--</div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script define:vars={{ FINNHUB_API_KEY, OPENBB_KEYS }}>
    class OpenBBDashboard {
      constructor() {
        this.apiKeys = OPENBB_KEYS;
        this.finnhubKey = FINNHUB_API_KEY;
        this.currentProvider = 'fmp';
        this.currentCategory = 'general';
        this.init();
      }

      async init() {
        this.setupEventListeners();
        await this.loadNews();
        this.updateStats();
      }

      setupEventListeners() {
        // æ•°æ®æºåˆ‡æ¢
        document.querySelectorAll('.source-btn').forEach(btn => {
          btn.addEventListener('click', (e) => {
            document.querySelectorAll('.source-btn').forEach(b => b.classList.remove('active'));
            e.target.classList.add('active');
            this.currentProvider = e.target.dataset.source;
            this.loadNews();
          });
        });

        // æ–°é—»ç­›é€‰
        document.getElementById('newsProvider').addEventListener('change', (e) => {
          this.currentProvider = e.target.value;
          this.loadNews();
        });

        document.getElementById('newsCategory').addEventListener('change', (e) => {
          this.currentCategory = e.target.value;
          this.loadNews();
        });

        // æ–°é—»åˆ·æ–°
        document.getElementById('btnRefreshNews').addEventListener('click', () => {
          this.loadNews();
        });

        // è‚¡ç¥¨æŸ¥è¯¢
        document.getElementById('btnGetQuote').addEventListener('click', () => {
          const symbol = document.getElementById('symbolInput').value;
          if (symbol) {
            this.getStockQuote(symbol);
          }
        });

        // æ§åˆ¶æŒ‰é’®
        document.getElementById('btnRefresh').addEventListener('click', () => {
          this.loadNews();
          this.updateStats();
        });

        document.getElementById('btnAnalyze').addEventListener('click', () => {
          this.runAnalysis();
        });

        document.getElementById('btnExport').addEventListener('click', () => {
          this.exportData();
        });

        document.getElementById('btnSettings').addEventListener('click', () => {
          this.showSettings();
        });

        document.getElementById('btnOpenBB').addEventListener('click', () => {
          this.showOpenBBInfo();
        });
      }

      async loadNews() {
        try {
          this.showLoading();
          
          // æ¨¡æ‹ŸAPIè°ƒç”¨ - å®é™…é¡¹ç›®ä¸­åº”è¯¥è°ƒç”¨åç«¯API
          const newsData = await this.fetchNewsData();
          this.displayNews(newsData);
          
        } catch (error) {
          console.error('åŠ è½½æ–°é—»å¤±è´¥:', error);
          this.showError('åŠ è½½æ–°é—»å¤±è´¥ï¼Œè¯·æ£€æŸ¥ç½‘ç»œè¿æ¥');
        }
      }

      async fetchNewsData() {
        // æ¨¡æ‹Ÿæ•°æ® - å®é™…é¡¹ç›®ä¸­åº”è¯¥è°ƒç”¨OpenBB API
        const mockNews = [
          {
            title: `OpenBBæ–°é—»æ ‡é¢˜ 1 - ${this.currentProvider}`,
            content: `è¿™æ˜¯æ¥è‡ª ${this.currentProvider} çš„æ¨¡æ‹Ÿæ–°é—»å†…å®¹ã€‚OpenBBå¹³å°æä¾›äº†å¼ºå¤§çš„æ•°æ®é›†æˆèƒ½åŠ›ã€‚`,
            source: this.currentProvider.toUpperCase(),
            date: new Date().toISOString(),
            sentiment: 'positive',
            confidence: 0.85
          },
          {
            title: `å¸‚åœºåˆ†ææŠ¥å‘Š - ${this.currentCategory}`,
            content: `å…³äº ${this.currentCategory} çš„è¯¦ç»†å¸‚åœºåˆ†ææŠ¥å‘Šï¼ŒåŒ…å«æœ€æ–°çš„å¸‚åœºè¶‹åŠ¿å’ŒæŠ•èµ„å»ºè®®ã€‚`,
            source: this.currentProvider.toUpperCase(),
            date: new Date(Date.now() - 3600000).toISOString(),
            sentiment: 'neutral',
            confidence: 0.72
          },
          {
            title: `æŠ€æœ¯æŒ‡æ ‡æ›´æ–°`,
            content: `æœ€æ–°çš„æŠ€æœ¯æŒ‡æ ‡æ˜¾ç¤ºå¸‚åœºå¯èƒ½å‡ºç°æ³¢åŠ¨ï¼ŒæŠ•èµ„è€…éœ€è¦è°¨æ…æ“ä½œã€‚`,
            source: this.currentProvider.toUpperCase(),
            date: new Date(Date.now() - 7200000).toISOString(),
            sentiment: 'negative',
            confidence: 0.68
          }
        ];

        return mockNews;
      }

      displayNews(newsData) {
        const newsPanel = document.getElementById('newsPanel');
        newsPanel.innerHTML = '';

        if (!newsData || newsData.length === 0) {
          newsPanel.innerHTML = '<div class="loading"><h3>ğŸ“­ æš‚æ— æ–°é—»</h3><p>è¯·å°è¯•åˆ·æ–°æˆ–é€‰æ‹©å…¶ä»–ç±»åˆ«</p></div>';
          return;
        }

        newsData.forEach((news, index) => {
          const newsItem = document.createElement('div');
          newsItem.className = `news-item ${news.sentiment}`;
          
          const sentimentBadge = news.sentiment ? 
            `<span class="sentiment-badge ${news.sentiment}">${news.sentiment}</span>` : '';

          newsItem.innerHTML = `
            <div class="news-header">
              <div class="news-title">${news.title}</div>
              <div class="news-source">${news.source}</div>
            </div>
            <div class="news-content">${news.content}</div>
            <div class="news-meta">
              <span class="news-date">${new Date(news.date).toLocaleString()}</span>
              ${sentimentBadge}
            </div>
          `;

          newsPanel.appendChild(newsItem);
        });
      }

      async getStockQuote(symbol) {
        try {
          // æ¨¡æ‹Ÿè‚¡ç¥¨æŠ¥ä»· - å®é™…é¡¹ç›®ä¸­åº”è¯¥è°ƒç”¨OpenBB API
          const quote = {
            symbol: symbol.toUpperCase(),
            price: (Math.random() * 200 + 50).toFixed(2),
            change: (Math.random() * 10 - 5).toFixed(2),
            changePercent: (Math.random() * 10 - 5).toFixed(2),
            volume: Math.floor(Math.random() * 10000000),
            marketCap: Math.floor(Math.random() * 1000000000000)
          };

          this.displayQuote(quote);
        } catch (error) {
          console.error('è·å–è‚¡ç¥¨æŠ¥ä»·å¤±è´¥:', error);
        }
      }

      displayQuote(quote) {
        const quoteDisplay = document.getElementById('quoteDisplay');
        const changeClass = parseFloat(quote.change) >= 0 ? 'positive' : 'negative';
        
        quoteDisplay.innerHTML = `
          <div class="quote-card">
            <div class="quote-symbol">${quote.symbol}</div>
            <div class="quote-price">$${quote.price}</div>
            <div class="quote-change ${changeClass}">
              ${quote.change >= 0 ? '+' : ''}${quote.change} (${quote.changePercent}%)
            </div>
            <div class="quote-meta">
              <div>æˆäº¤é‡: ${quote.volume.toLocaleString()}</div>
              <div>å¸‚å€¼: $${(quote.marketCap / 1000000000).toFixed(1)}B</div>
            </div>
          </div>
        `;
      }

      updateStats() {
        // æ¨¡æ‹Ÿç»Ÿè®¡æ•°æ®
        document.getElementById('totalNews').textContent = Math.floor(Math.random() * 1000) + 500;
        document.getElementById('dataSources').textContent = '5';
        document.getElementById('marketData').textContent = Math.floor(Math.random() * 100) + 50;
        document.getElementById('economyIndicators').textContent = Math.floor(Math.random() * 20) + 10;
      }

      showLoading() {
        const newsPanel = document.getElementById('newsPanel');
        newsPanel.innerHTML = `
          <div class="loading">
            <div class="loading-spinner"></div>
            <h3>æ­£åœ¨åŠ è½½æ–°é—»...</h3>
            <p>è¯·ç¨å€™</p>
          </div>
        `;
      }

      showError(message) {
        const newsPanel = document.getElementById('newsPanel');
        newsPanel.innerHTML = `
          <div class="loading">
            <h3>âš ï¸ é”™è¯¯</h3>
            <p>${message}</p>
          </div>
        `;
      }

      runAnalysis() {
        alert('ğŸ§  æ™ºèƒ½åˆ†æåŠŸèƒ½å¼€å‘ä¸­...\n\nå°†åŒ…æ‹¬ï¼š\n- æƒ…æ„Ÿåˆ†æ\n- è¶‹åŠ¿é¢„æµ‹\n- é£é™©è¯„ä¼°\n- æŠ•èµ„å»ºè®®');
      }

      exportData() {
        alert('ğŸ“¤ å¯¼å‡ºåŠŸèƒ½å¼€å‘ä¸­...\n\nå°†æ”¯æŒï¼š\n- JSONæ ¼å¼\n- CSVæ ¼å¼\n- PDFæŠ¥å‘Š\n- Excelæ–‡ä»¶');
      }

      showSettings() {
        alert('âš™ï¸ è®¾ç½®åŠŸèƒ½å¼€å‘ä¸­...\n\nå°†åŒ…æ‹¬ï¼š\n- APIå¯†é’¥ç®¡ç†\n- æ•°æ®æºé…ç½®\n- æ›´æ–°é¢‘ç‡è®¾ç½®\n- é€šçŸ¥åå¥½');
      }

      showOpenBBInfo() {
        alert('ğŸ”— OpenBBé›†æˆä¿¡æ¯\n\nå½“å‰é›†æˆçŠ¶æ€ï¼š\n- æ•°æ®æºï¼šFMP, Benzinga, Intrinio\n- åŠŸèƒ½ï¼šæ–°é—»ã€æŠ¥ä»·ã€ç»æµæŒ‡æ ‡\n- çŠ¶æ€ï¼šå¼€å‘ä¸­\n\nä¸‹ä¸€æ­¥ï¼š\n- å®Œæ•´APIé›†æˆ\n- å®æ—¶æ•°æ®æµ\n- é«˜çº§åˆ†æåŠŸèƒ½');
      }
    }

    // åˆå§‹åŒ–ä»ªè¡¨æ¿
    new OpenBBDashboard();
  </script>
</Layout>










