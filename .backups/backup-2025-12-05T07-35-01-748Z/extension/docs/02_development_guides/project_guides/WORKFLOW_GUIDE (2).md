# JQQuant å®Œæ•´å·¥ä½œæµç¨‹æŒ‡å—

æœ¬æ–‡æ¡£æŒ‰ç…§é‡åŒ–æŠ•èµ„çš„æ ‡å‡†æµç¨‹ï¼Œè¯¦ç»†è¯´æ˜ä»ç¯å¢ƒå‡†å¤‡åˆ°ç­–ç•¥ä¼˜åŒ–ã€ç»“æœåˆ†æã€ç‰ˆæœ¬ç®¡ç†çš„å®Œæ•´å·¥ä½œæµç¨‹ã€‚

---

## ğŸ“‹ ç›®å½•

1. [ç¯å¢ƒå‡†å¤‡ä¸é…ç½®](#1-ç¯å¢ƒå‡†å¤‡ä¸é…ç½®)
2. [ç­–ç•¥å¼€å‘](#2-ç­–ç•¥å¼€å‘)
3. [æ•°æ®å‡†å¤‡ä¸è‚¡ç¥¨æ± é…ç½®](#3-æ•°æ®å‡†å¤‡ä¸è‚¡ç¥¨æ± é…ç½®)
4. [è¿è¡Œå›æµ‹](#4-è¿è¡Œå›æµ‹)
5. [ç»“æœåˆ†æä¸æŠ¥å‘Šç”Ÿæˆ](#5-ç»“æœåˆ†æä¸æŠ¥å‘Šç”Ÿæˆ)
6. [ç‰ˆæœ¬æ§åˆ¶ä¸ä»£ç ç®¡ç†](#6-ç‰ˆæœ¬æ§åˆ¶ä¸ä»£ç ç®¡ç†)
7. [æŒç»­ä¼˜åŒ–ä¸æ”¹è¿›](#7-æŒç»­ä¼˜åŒ–ä¸æ”¹è¿›)
8. [å¸¸è§é—®é¢˜ä¸æ•…éšœæ’é™¤](#8-å¸¸è§é—®é¢˜ä¸æ•…éšœæ’é™¤)

---

## 1. ç¯å¢ƒå‡†å¤‡ä¸é…ç½®

### 1.1 ç³»ç»Ÿè¦æ±‚

- **æ“ä½œç³»ç»Ÿ**: Windows 10/11
- **Pythonç‰ˆæœ¬**: 3.8 æˆ–æ›´é«˜
- **Git**: ç”¨äºç‰ˆæœ¬æ§åˆ¶ï¼ˆå¯é€‰ï¼Œä½†æ¨èï¼‰

### 1.2 å®‰è£…Pythonä¾èµ–

```powershell
# è¿›å…¥é¡¹ç›®ç›®å½•
cd C:\JQQuant

# æ¿€æ´»è™šæ‹Ÿç¯å¢ƒï¼ˆå¦‚æœä½¿ç”¨ï¼‰
.\jqdata_env\Scripts\Activate.ps1

# å®‰è£…ä¾èµ–
pip install -r requirements.txt
```

**é‡è¦ä¾èµ–è¯´æ˜ï¼š**

- `jqdatasdk` - èšå®½æ•°æ®APIï¼ˆå¿…éœ€ï¼‰
- `pandas`, `numpy` - æ•°æ®å¤„ç†ï¼ˆå¿…éœ€ï¼‰
- `matplotlib`, `plotly` - å¯è§†åŒ–ï¼ˆå¿…éœ€ï¼‰
- `TA-Lib` - æŠ€æœ¯æŒ‡æ ‡ï¼ˆå¯é€‰ï¼Œä½†æ¨èï¼‰

**TA-Lib Windowså®‰è£…ï¼š**

1. è®¿é—®ï¼šhttps://www.lfd.uci.edu/~gohlke/pythonlibs/#ta-lib
2. ä¸‹è½½å¯¹åº”Pythonç‰ˆæœ¬çš„whlæ–‡ä»¶ï¼ˆå¦‚ `TA_Libâ€‘0.4.xxâ€‘cp38â€‘cp38â€‘win_amd64.whl`ï¼‰
3. å®‰è£…ï¼š`pip install TA_Libâ€‘0.4.xxâ€‘cp38â€‘cp38â€‘win_amd64.whl`

### 1.3 é…ç½®èšå®½è´¦å·

ç¼–è¾‘ `config/jqdata_config.json`ï¼š

```json
{
  "username": "æ‚¨çš„èšå®½ç”¨æˆ·åæˆ–æ‰‹æœºå·",
  "password": "æ‚¨çš„èšå®½å¯†ç ",
  "api_endpoint": "https://dataapi.joinquant.com",
  "timeout": 30,
  "retry_times": 3
}
```

**å®‰å…¨æç¤ºï¼š**
- âš ï¸ é…ç½®æ–‡ä»¶å·²è‡ªåŠ¨æ’é™¤åœ¨Gitä»“åº“å¤–ï¼ˆ`.gitignore`ï¼‰
- âš ï¸ è¯·å‹¿å°†è´¦å·å¯†ç æäº¤åˆ°å…¬å…±ä»“åº“
- âš ï¸ ç”Ÿäº§ç¯å¢ƒå»ºè®®ä½¿ç”¨ç¯å¢ƒå˜é‡æˆ–å¯†é’¥ç®¡ç†å·¥å…·

### 1.4 éªŒè¯å®‰è£…

è¿è¡Œæµ‹è¯•è„šæœ¬éªŒè¯æ‰€æœ‰æ¨¡å—æ˜¯å¦æ­£ç¡®å®‰è£…ï¼š

```powershell
python test_imports.py
```

### 1.5 åˆ¸å•†ä¸äº¤æ˜“é€šé“è§„åˆ’

- **ä¸»é€šé“ï¼šåæ³°è¯åˆ¸ + QMTï¼ˆQuick Model Tradeï¼‰**
  - æœ¬åœ°éƒ¨ç½²ï¼Œå†…å­˜çº§æ’®åˆï¼Œå•ç¬”ä¸‹å•å»¶è¿Ÿ <1msï¼Œæ”¯æŒè‚¡ç¥¨ã€æœŸè´§ã€æœŸæƒã€ä¸¤èã€æ¸¯è‚¡é€šç­‰å¤šå¸‚åœºå“ç§ã€‚
  - ç­–ç•¥è¿è¡Œåœ¨è‡ªæœ‰ç¯å¢ƒï¼Œå¯è‡ªç”±ä½¿ç”¨ Python ç¬¬ä¸‰æ–¹åº“ï¼Œç­–ç•¥ä»£ç å’Œæ•°æ®å®Œå…¨æŒæ§ã€‚
  - å»ºè®®å¼€æˆ·æ—¶åŒæ­¥ç”³è¯·æé€ŸæŸœå° / VIP é€šé“ä¸ Level-2 è¡Œæƒ…ï¼Œç¡®ä¿è¡Œæƒ…ä¸å§”æ‰˜é€Ÿåº¦ã€‚
- **å¤‡ç”¨é€šé“ï¼šå›½é‡‘è¯åˆ¸ + PTradeï¼ˆåˆ¸å•†äº‘æ‰˜ç®¡ï¼‰**
  - ç­–ç•¥ä¸Šä¼ åç”±åˆ¸å•†æœºæˆ¿ 7Ã—24 ç»´æŠ¤ï¼Œå…è¿ç»´å‹åŠ›ï¼Œé€‚åˆå¿«é€Ÿéƒ¨ç½²æˆ–ç¾å¤‡ã€‚
  - ç¯å¢ƒå°é—­ï¼Œæ‰©å±•ç¬¬ä¸‰æ–¹åº“å—é™ï¼Œå¯¹ç­–ç•¥ä¿å¯†æ€§ä¾èµ–äºåˆ¸å•†éš”ç¦»æœºåˆ¶ã€‚
- **æ‰§è¡Œå»ºè®®ï¼š** ä¸»è´¦æˆ·éƒ¨ç½²åœ¨åæ³° + QMTï¼Œä»¥è·å¾—é«˜æ€§èƒ½å’Œçµæ´»åº¦ï¼›å›½é‡‘ + PTrade ä½œä¸ºå¤‡ç”¨è´¦æˆ·ï¼Œç”¨äºç­–ç•¥æ‰˜ç®¡æˆ–ç´§æ€¥åˆ‡æ¢ï¼Œå¢å¼ºç³»ç»Ÿå¼¹æ€§ä¸å®¹ç¾èƒ½åŠ›ã€‚

---

## 2. ç­–ç•¥å¼€å‘

### 2.1 äº†è§£ç­–ç•¥åŸºç±»

æ‰€æœ‰ç­–ç•¥éƒ½ç»§æ‰¿è‡ª `BaseStrategy`ï¼Œä½äº `strategies/base_strategy.py`ã€‚

**æ ¸å¿ƒæ–¹æ³•ï¼š**

- `initialize(context)` - ç­–ç•¥åˆå§‹åŒ–ï¼Œåœ¨å›æµ‹å¼€å§‹å‰è°ƒç”¨ä¸€æ¬¡
- `handle_data(data, date)` - å¤„ç†æ¯æ—¥æ•°æ®ï¼Œæ¯ä¸ªäº¤æ˜“æ—¥è°ƒç”¨ä¸€æ¬¡
- `get_parameters()` - è¿”å›ç­–ç•¥å‚æ•°ï¼ˆç”¨äºæŠ¥å‘Šç”Ÿæˆï¼‰

### 2.2 åˆ›å»ºæ–°ç­–ç•¥

#### æ­¥éª¤1ï¼šåˆ›å»ºç­–ç•¥æ–‡ä»¶

åœ¨ `strategies/examples/` ç›®å½•ä¸‹åˆ›å»ºæ–°æ–‡ä»¶ï¼Œä¾‹å¦‚ `my_strategy.py`ï¼š

```python
# -*- coding: utf-8 -*-
"""
æˆ‘çš„è‡ªå®šä¹‰ç­–ç•¥
"""
from strategies.base_strategy import BaseStrategy
import pandas as pd
from datetime import datetime
from core.order_manager import OrderType

class MyStrategy(BaseStrategy):
    def __init__(self, param1=10, param2=20):
        """
        åˆå§‹åŒ–ç­–ç•¥
        
        Args:
            param1: å‚æ•°1è¯´æ˜
            param2: å‚æ•°2è¯´æ˜
        """
        super().__init__(name="My Strategy")
        self.param1 = param1
        self.param2 = param2
    
    def initialize(self, context):
        """ç­–ç•¥åˆå§‹åŒ–"""
        super().initialize(context)
        # åœ¨è¿™é‡Œå¯ä»¥ï¼š
        # - è·å–è‚¡ç¥¨åˆ—è¡¨
        # - è®¾ç½®åˆå§‹å‚æ•°
        # - åˆå§‹åŒ–æŒ‡æ ‡è®¡ç®—
        logger = context.get('logger')
        if logger:
            logger.info(f"ç­–ç•¥ {self.name} åˆå§‹åŒ–å®Œæˆ")
    
    def handle_data(self, data: pd.DataFrame, date: datetime):
        """
        å¤„ç†æ¯æ—¥æ•°æ®
        
        Args:
            data: å½“æ—¥æ‰€æœ‰è‚¡ç¥¨çš„æ•°æ®ï¼ˆDataFrameï¼‰
            date: å½“å‰æ—¥æœŸ
        """
        # è·å–ä¸Šä¸‹æ–‡å¯¹è±¡
        portfolio = self.context['portfolio']
        order_manager = self.context['order_manager']
        data_provider = self.context['data_provider']
        securities = self.context['securities']
        
        # ç­–ç•¥é€»è¾‘ç¤ºä¾‹
        for security in securities:
            # è·å–å½“å‰æŒä»“
            position = portfolio.get_position(security)
            has_position = position is not None and position.amount > 0
            
            # è·å–è‚¡ç¥¨æ•°æ®
            stock_data = data[data['code'] == security]
            if stock_data.empty:
                continue
            
            current_price = stock_data.iloc[0]['close']
            
            # ç¤ºä¾‹ï¼šç®€å•çš„ä¹°å…¥å–å‡ºé€»è¾‘
            if not has_position:
                # ä¹°å…¥æ¡ä»¶ï¼ˆç¤ºä¾‹ï¼‰
                if self._should_buy(stock_data):
                    # è®¡ç®—ä¹°å…¥æ•°é‡ï¼ˆä½¿ç”¨æ€»èµ„é‡‘çš„15%ï¼‰
                    cash = portfolio.current_cash
                    target_value = cash * 0.15
                    shares = int(target_value / current_price / 100) * 100  # æŒ‰æ‰‹ä¹°å…¥
                    
                    if shares > 0:
                        order_manager.create_order(
                            security, 
                            shares, 
                            order_type=OrderType.MARKET
                        )
            else:
                # å–å‡ºæ¡ä»¶ï¼ˆç¤ºä¾‹ï¼‰
                if self._should_sell(stock_data, position):
                    order_manager.create_order(
                        security, 
                        -position.amount, 
                        order_type=OrderType.MARKET
                    )
    
    def _should_buy(self, stock_data):
        """ä¹°å…¥æ¡ä»¶åˆ¤æ–­"""
        # å®ç°æ‚¨çš„ä¹°å…¥é€»è¾‘
        # ä¾‹å¦‚ï¼šæŠ€æœ¯æŒ‡æ ‡ã€åŸºæœ¬é¢åˆ†æç­‰
        return False
    
    def _should_sell(self, stock_data, position):
        """å–å‡ºæ¡ä»¶åˆ¤æ–­"""
        # å®ç°æ‚¨çš„å–å‡ºé€»è¾‘
        # ä¾‹å¦‚ï¼šæ­¢æŸã€æ­¢ç›ˆã€æŠ€æœ¯æŒ‡æ ‡ç­‰
        return False
    
    def get_parameters(self):
        """è¿”å›ç­–ç•¥å‚æ•°ï¼ˆç”¨äºæŠ¥å‘Šç”Ÿæˆï¼‰"""
        return {
            'param1': self.param1,
            'param2': self.param2
        }
```

#### æ­¥éª¤2ï¼šæ³¨å†Œç­–ç•¥

åœ¨ `main.py` çš„ `load_strategy` å‡½æ•°ä¸­æ·»åŠ ï¼š

```python
def load_strategy(strategy_name: str, **kwargs):
    if strategy_name == 'ma_cross':
        # ... ç°æœ‰ä»£ç 
    elif strategy_name == 'adaptive_momentum':
        # ... ç°æœ‰ä»£ç 
    elif strategy_name == 'my_strategy':
        from strategies.examples.my_strategy import MyStrategy
        return MyStrategy(
            param1=kwargs.get('param1', 10),
            param2=kwargs.get('param2', 20)
        )
    else:
        raise ValueError(f"æœªçŸ¥çš„ç­–ç•¥: {strategy_name}")
```

#### æ­¥éª¤3ï¼šæµ‹è¯•ç­–ç•¥

åˆ›å»ºæµ‹è¯•è„šæœ¬ `test_my_strategy.py`ï¼š

```python
from main import run_backtest

results = run_backtest(
    strategy_name='my_strategy',
    start_date='2023-01-01',
    end_date='2023-12-31',
    securities=['000001.XSHE'],
    initial_cash=1000000,
    strategy_params={
        'param1': 10,
        'param2': 20
    }
)

if results:
    print(f"å›æµ‹å®Œæˆï¼æ€»æ”¶ç›Š: {results['summary']['total_profit_rate']*100:.2f}%")
```

### 2.3 å‚è€ƒç¤ºä¾‹ç­–ç•¥

é¡¹ç›®åŒ…å«å¤šä¸ªç¤ºä¾‹ç­–ç•¥ï¼Œå¯ä½œä¸ºå‚è€ƒï¼š

- **`ma_cross.py`** - å‡çº¿äº¤å‰ç­–ç•¥ï¼ˆç®€å•ç¤ºä¾‹ï¼‰
- **`adaptive_momentum.py`** - è‡ªé€‚åº”åŠ¨é‡ç­–ç•¥
- **`adaptive_momentum_a.py`** - è‡ªé€‚åº”åŠ¨é‡ç­–ç•¥Aè‚¡ç‰ˆæœ¬
- **`adaptive_momentum_a_v2.py`** - è‡ªé€‚åº”åŠ¨é‡ç­–ç•¥Aè‚¡v2.0ï¼ˆæœ€æ–°ç‰ˆæœ¬ï¼‰

---

## 3. æ•°æ®å‡†å¤‡ä¸è‚¡ç¥¨æ± é…ç½®

### 3.1 è‚¡ç¥¨ä»£ç æ ¼å¼

èšå®½ä½¿ç”¨ç‰¹å®šçš„è‚¡ç¥¨ä»£ç æ ¼å¼ï¼š

- **æ·±åœ³è‚¡ç¥¨**: `000001.XSHE` (å¹³å®‰é“¶è¡Œ)
- **ä¸Šæµ·è‚¡ç¥¨**: `600000.XSHG` (æµ¦å‘é“¶è¡Œ)
- **åˆ›ä¸šæ¿**: `300750.XSHE` (å®å¾·æ—¶ä»£)
- **ç§‘åˆ›æ¿**: `688111.XSHG` (é‡‘å±±åŠå…¬)
- **æŒ‡æ•°**: `000300.XSHG` (æ²ªæ·±300)

### 3.2 é…ç½®è‚¡ç¥¨æ± 

#### æ–¹å¼1ï¼šä½¿ç”¨é…ç½®æ–‡ä»¶

ç¼–è¾‘ `config/stock_pool.json`ï¼š

```json
{
  "default": [
    "000001.XSHE",
    "000002.XSHE",
    "600000.XSHG",
    "600036.XSHG"
  ],
  "new_energy": [
    "300750.XSHE",
    "002594.XSHE",
    "300014.XSHE"
  ],
  "semiconductor": [
    "002415.XSHE",
    "600584.XSHG",
    "002049.XSHE"
  ]
}
```

åœ¨ä»£ç ä¸­ä½¿ç”¨ï¼š

```python
from config.config_manager import get_config_manager

config_manager = get_config_manager()
stock_pool = config_manager.get_stock_pool('new_energy')
```

#### æ–¹å¼2ï¼šåŠ¨æ€è·å–è‚¡ç¥¨æ± 

```python
from jqdata.client import JQDataClient
from config.config_manager import get_config_manager

# åˆå§‹åŒ–å®¢æˆ·ç«¯
config_manager = get_config_manager()
config = config_manager.get_jqdata_config()
jq_client = JQDataClient()
jq_client.authenticate(config['username'], config['password'])

# è·å–æŒ‡æ•°æˆåˆ†è‚¡
hs300_stocks = jq_client.get_index_stocks('000300.XSHG', date='2023-12-31')
print(f"æ²ªæ·±300æˆåˆ†è‚¡æ•°é‡: {len(hs300_stocks)}")

# è·å–æ‰€æœ‰è‚¡ç¥¨
all_stocks = jq_client.get_all_securities(types=['stock'], date='2023-12-31')
print(f"æ€»è‚¡ç¥¨æ•°é‡: {len(all_stocks)}")
```

### 3.3 æ£€æŸ¥æ•°æ®å¯ç”¨æ€§

åœ¨è¿è¡Œå›æµ‹å‰ï¼Œå»ºè®®å…ˆæ£€æŸ¥æ•°æ®å¯ç”¨æ€§ï¼š

```powershell
# æ£€æŸ¥æ—¥æœŸèŒƒå›´å’Œæ•°æ®å¯ç”¨æ€§
python check_date_range.py --start 2020-01-01 --end 2023-12-31 --securities 000001.XSHE
```

### 3.4 æ•°æ®æºç­–ç•¥

- **å®æ—¶è¡Œæƒ…ï¼ˆå®ç›˜ï¼‰**ï¼šä½¿ç”¨åæ³° QMT/å›½é‡‘ PTrade æä¾›çš„ Level-2 äº”æ¡£è¡Œæƒ…ä½œä¸ºä¸»è¡Œæƒ…æºï¼Œæ»¡è¶³æ¯«ç§’çº§æ¨é€éœ€æ±‚ã€‚
- **å†å²è¡Œæƒ…ï¼ˆå›æµ‹/ç ”ç©¶ï¼‰**ï¼šè®¢é˜… Wind ç­‰ä¸“ä¸šæ•°æ®æœåŠ¡è·å– Tickã€åˆ†é’Ÿã€æ—¥çº¿å…¨é‡æ•°æ®ï¼Œå¹¶å®šæœŸåŒæ­¥è‡³æœ¬åœ°æ•°æ®åº“ï¼ˆHDF5/Parquet æˆ– ClickHouseï¼‰ã€‚
- **è´¢åŠ¡ä¸åŸºæœ¬é¢æ•°æ®**ï¼šä¼˜å…ˆä½¿ç”¨ Wind è´¢åŠ¡æ•°æ®åº“ï¼Œè¦†ç›–ä¸Šå¸‚å…¬å¸è´¢æŠ¥ã€ç›ˆåˆ©èƒ½åŠ›ã€æˆé•¿æŒ‡æ ‡ç­‰ï¼›å¿…è¦æ—¶ä½¿ç”¨ TuShare Pro ä½œä¸ºä½æˆæœ¬è¡¥å……ã€‚
- **ä¼°å€¼ä¸é‡åŒ–å› å­**ï¼šç›´æ¥è°ƒç”¨ Wind ä¼°å€¼ä¸å› å­æ¥å£ï¼Œä¿è¯å¸‚ç›ˆç‡ã€PBã€é£æ ¼å› å­ç­‰æŒ‡æ ‡çš„å‡†ç¡®æ€§ï¼›è‹¥éœ€è‡ªå»ºå› å­ï¼Œå¯ç»“åˆè‡ªæœ‰è¡Œæƒ…ä¸è´¢åŠ¡æ•°æ®æ‰¹é‡è®¡ç®—ã€‚
- **è¡Œä¸šåˆ†ç±»åŸºå‡†**ï¼šç»Ÿä¸€é‡‡ç”¨ç”³ä¸‡è¡Œä¸šåˆ†ç±»ä½œä¸ºä¸­æ€§åŒ–ä¸é£æ§çš„æ ‡å‡†ï¼Œå®šæœŸæ ¡å‡†å†å²è¡Œä¸šæ˜ å°„ã€‚
- **æ•°æ®æ²»ç†**ï¼šå»ºç«‹æ•°æ®æ ¡éªŒæµç¨‹ï¼ˆç¼ºå¤±å€¼ã€å¼‚å¸¸å€¼ã€è‚¡ç¥¨æ•°é‡å¯¹é½ï¼‰ï¼Œå›æµ‹æ•°æ®ä¸å®ç›˜æ•°æ®ä¿æŒä¸€è‡´çš„å¤æƒå’Œå¸ç§å¤„ç†ï¼Œç¡®ä¿ç ”ç©¶ç»“è®ºå¯é ã€‚

---

## 4. è¿è¡Œå›æµ‹

### 4.1 å‘½ä»¤è¡Œè¿è¡Œï¼ˆæ¨èï¼‰

#### åŸºæœ¬å‘½ä»¤

```powershell
python main.py --strategy <ç­–ç•¥å> --start <å¼€å§‹æ—¥æœŸ> --end <ç»“æŸæ—¥æœŸ> --securities <è‚¡ç¥¨ä»£ç åˆ—è¡¨>
```

#### å®Œæ•´å‚æ•°ç¤ºä¾‹

```powershell
python main.py `
    --strategy adaptive_momentum_a_v2 `
    --start 2020-01-01 `
    --end 2023-12-31 `
    --securities 000001.XSHE 000002.XSHE 600000.XSHG `
    --cash 1000000 `
    --commission 0.0003 `
    --slippage 0.001 `
    --benchmark 000300.XSHG `
    --roc-10-min 0.02 `
    --roc-20-min 0.03 `
    --max-positions 7 `
    --position-size 0.15 `
    --stop-loss 0.10 `
    --take-profit 0.50
```

#### å‚æ•°è¯´æ˜

**é€šç”¨å‚æ•°ï¼š**
- `--strategy` / `-s`: ç­–ç•¥åç§°ï¼ˆå¿…éœ€ï¼‰
- `--start`: å›æµ‹å¼€å§‹æ—¥æœŸï¼Œæ ¼å¼ï¼šYYYY-MM-DDï¼ˆå¿…éœ€ï¼‰
- `--end`: å›æµ‹ç»“æŸæ—¥æœŸï¼Œæ ¼å¼ï¼šYYYY-MM-DDï¼ˆå¿…éœ€ï¼‰
- `--securities` / `-stocks`: è‚¡ç¥¨ä»£ç åˆ—è¡¨ï¼Œç©ºæ ¼åˆ†éš”ï¼ˆå¿…éœ€ï¼‰
- `--cash`: åˆå§‹èµ„é‡‘ï¼ˆé»˜è®¤ï¼š1000000ï¼‰
- `--commission`: æ‰‹ç»­è´¹ç‡ï¼ˆé»˜è®¤ï¼š0.0003ï¼Œå³0.03%ï¼‰
- `--slippage`: æ»‘ç‚¹ï¼ˆé»˜è®¤ï¼š0.001ï¼Œå³0.1%ï¼‰

**MAäº¤å‰ç­–ç•¥å‚æ•°ï¼š**
- `--short-window`: çŸ­æœŸå‡çº¿å‘¨æœŸï¼ˆé»˜è®¤ï¼š5ï¼‰
- `--long-window`: é•¿æœŸå‡çº¿å‘¨æœŸï¼ˆé»˜è®¤ï¼š20ï¼‰

**è‡ªé€‚åº”åŠ¨é‡ç­–ç•¥å‚æ•°ï¼š**
- `--benchmark`: åŸºå‡†æŒ‡æ•°ï¼ˆé»˜è®¤ï¼š000300.XSHGï¼‰
- `--roc-10-min`: ROC10æœ€å°å€¼ï¼ˆé»˜è®¤ï¼š0.02ï¼‰
- `--roc-20-min`: ROC20æœ€å°å€¼ï¼ˆé»˜è®¤ï¼š0.03ï¼‰
- `--max-positions`: æœ€å¤§æŒä»“æ•°ï¼ˆé»˜è®¤ï¼š7ï¼‰
- `--position-size`: å•åªè‚¡ç¥¨ä»“ä½ï¼ˆé»˜è®¤ï¼š0.15ï¼Œå³15%ï¼‰
- `--stop-loss`: æ­¢æŸæ¯”ä¾‹ï¼ˆé»˜è®¤ï¼š0.10ï¼Œå³10%ï¼‰
- `--take-profit`: æ­¢ç›ˆæ¯”ä¾‹ï¼ˆé»˜è®¤ï¼š0.50ï¼Œå³50%ï¼‰

### 4.2 è‡ªåŠ¨åŒ–è¿è¡Œè„šæœ¬

é¡¹ç›®æä¾›ç»Ÿä¸€çš„å›æµ‹å…¥å£ `scripts/run_backtest_report.py`ï¼Œç”¨äºç”Ÿæˆå¸¦ç¼–å·çš„å›æµ‹ç›®å½•åŠ HTML æŠ¥å‘Šï¼ˆè¯¦è§ä¸Šæ–‡è¯´æ˜ï¼‰ã€‚
ä¸ºå…¼å®¹å†å²æµç¨‹ï¼Œä»ä¿ç•™ `run_adaptive_momentum_a.py` / `run_adaptive_momentum_a_v2.py` ç­‰å¿«æ·è„šæœ¬ï¼Œå®ƒä»¬å†…éƒ¨ä¼šè°ƒç”¨ `run_backtest`ï¼Œæœ€ç»ˆäº§å‡ºä¸è‡ªåŠ¨åŒ–è„šæœ¬ç›¸åŒçš„ç›®å½•ç»“æ„ã€‚

```powershell
python scripts/run_backtest_report.py ^
    --strategy adaptive_momentum_a_v2 ^
    --start 2024-08-01 --end 2024-10-31 ^
    --keyword full_refresh ^
    --theme default
```

### 4.3 åœ¨Cursorä¸­è¿è¡Œ

1. æŒ‰ `Ctrl+Shift+P` æ‰“å¼€å‘½ä»¤é¢æ¿
2. è¾“å…¥ "Tasks: Run Task"
3. é€‰æ‹© "JQQuant: è¿è¡Œå›æµ‹"

**ä¿®æ”¹ä»»åŠ¡å‚æ•°ï¼š**

ç¼–è¾‘ `.vscode/tasks.json`ï¼Œä¿®æ”¹ `args` éƒ¨åˆ†ã€‚

### 4.4 å›æµ‹æ‰§è¡Œæµç¨‹

å›æµ‹å¼•æ“æŒ‰ä»¥ä¸‹æµç¨‹æ‰§è¡Œï¼š

1. **åˆå§‹åŒ–é˜¶æ®µ**
   - åˆå§‹åŒ–èšå®½å®¢æˆ·ç«¯å¹¶è®¤è¯
   - åˆå§‹åŒ–æ•°æ®æä¾›è€…
   - åˆå§‹åŒ–å›æµ‹å¼•æ“ï¼ˆè®¾ç½®åˆå§‹èµ„é‡‘ã€æ‰‹ç»­è´¹ã€æ»‘ç‚¹ï¼‰
   - åŠ è½½ç­–ç•¥å¹¶è°ƒç”¨ `initialize()`

2. **æ•°æ®è·å–é˜¶æ®µ**
   - è·å–æŒ‡å®šæ—¥æœŸèŒƒå›´å†…çš„æ‰€æœ‰äº¤æ˜“æ—¥
   - è·å–æ‰€æœ‰è‚¡ç¥¨çš„å†å²æ•°æ®
   - éªŒè¯æ•°æ®å®Œæ•´æ€§

3. **å›æµ‹æ‰§è¡Œé˜¶æ®µ**
   - æŒ‰æ—¥æœŸé¡ºåºéå†æ¯ä¸ªäº¤æ˜“æ—¥
   - å¯¹æ¯ä¸ªäº¤æ˜“æ—¥ï¼š
     - æ›´æ–°æŒä»“å¸‚å€¼
     - è°ƒç”¨ç­–ç•¥çš„ `handle_data()` æ–¹æ³•
     - æ‰§è¡Œè®¢å•ï¼ˆä¹°å…¥/å–å‡ºï¼‰
     - æ›´æ–°æŠ•èµ„ç»„åˆçŠ¶æ€
     - è®°å½•äº¤æ˜“å†å²

4. **ç»“æœè®¡ç®—é˜¶æ®µ**
   - è®¡ç®—æ”¶ç›ŠæŒ‡æ ‡ï¼ˆæ€»æ”¶ç›Šã€å¹´åŒ–æ”¶ç›Šç­‰ï¼‰
   - è®¡ç®—é£é™©æŒ‡æ ‡ï¼ˆæœ€å¤§å›æ’¤ã€å¤æ™®æ¯”ç‡ç­‰ï¼‰
   - ç”Ÿæˆäº¤æ˜“ç»Ÿè®¡

5. **ç»“æœä¿å­˜é˜¶æ®µ**
   - å°† JSON æŒ‡æ ‡ã€å…ƒæ•°æ®ä¸å›¾è¡¨èµ„äº§å†™å…¥ `strategies/<ç­–ç•¥æ—>/backtests/<ç¼–å·_å…³é”®è¯_æ—¥æœŸ>/`
   - ç”Ÿæˆ HTML æŠ¥å‘Šï¼Œå¹¶åŒæ­¥ä¸€ä»½å‰¯æœ¬è‡³ `strategies/<ç­–ç•¥æ—>/reports/` ç›®å½•ï¼ˆå…¼å®¹æ—§å…¥å£ï¼‰
   - æ›´æ–° `strategies/<ç­–ç•¥æ—>/backtests/index.json` ç´¢å¼•æ–‡ä»¶
   - è¾“å‡ºæ§åˆ¶å°æ‘˜è¦

---

## 5. ç»“æœåˆ†æä¸æŠ¥å‘Šç”Ÿæˆ

### 5.1 æŸ¥çœ‹å›æµ‹ç»“æœ

#### æ§åˆ¶å°è¾“å‡º

å›æµ‹å®Œæˆåï¼Œæ§åˆ¶å°ä¼šæ˜¾ç¤ºå…³é”®æŒ‡æ ‡ï¼š

```
============================================================
å›æµ‹ç»“æœ
============================================================
åˆå§‹èµ„é‡‘: 1,000,000.00
æœ€ç»ˆèµ„äº§: 1,200,000.00
æ€»æ”¶ç›Š: 200,000.00 (20.00%)
å¹´åŒ–æ”¶ç›Š: 5.00%
å¤æ™®æ¯”ç‡: 1.20
æœ€å¤§å›æ’¤: 15.00%
æ€»äº¤æ˜“æ¬¡æ•°: 50
```

#### JSONç»“æœæ–‡ä»¶

ç»“æœä¼šè¢«å†™å…¥ç­–ç•¥ä¸“å±çš„å›æµ‹ç›®å½•ï¼Œè·¯å¾„æ ¼å¼ï¼š
```
strategies/<ç­–ç•¥æ—>/backtests/<ç¼–å·_å…³é”®è¯_æ—¥æœŸ>/metrics.json
```

æ¯ä¸ªç›®å½•è¿˜åŒ…å« `metadata.json`ï¼ˆå…ƒæ•°æ®ï¼‰ã€`report.html`ï¼ˆä¸»æŠ¥å‘Šï¼‰ä»¥åŠ `artifacts/` å­ç›®å½•ï¼ˆç¼“å­˜å›¾è¡¨/é™„è¡¨ï¼‰ã€‚ä¸ºäº†å…¼å®¹æ—§å…¥å£ï¼ŒåŒå HTML æŠ¥å‘Šä¼šåŒæ­¥ä¸€ä»½å‰¯æœ¬è‡³ `strategies/<ç­–ç•¥æ—>/reports/`ã€‚

**metrics.json ç»“æ„ç¤ºä¾‹ï¼š**

```json
{
  "strategy": "adaptive_momentum_a_v2",
  "start_date": "2020-01-01",
  "end_date": "2023-12-31",
  "securities": ["000001.XSHE", "000002.XSHE"],
  "summary": {
    "initial_cash": 1000000,
    "current_cash": 950000,
    "total_value": 1200000,
    "total_profit": 200000,
    "total_profit_rate": 0.2
  },
  "metrics": {
    "total_return": 0.2,
    "annual_return": 0.05,
    "sharpe_ratio": 1.2,
    "max_drawdown": 0.15,
    "total_trades": 50
  },
  "trade_history": [...],
  "portfolio_history": [...]
}
```

### 5.2 ç”ŸæˆHTMLæŠ¥å‘Š

å›æµ‹å®Œæˆåä¼šè‡ªåŠ¨ç”ŸæˆHTMLæŠ¥å‘Šï¼ŒåŒ…å«ï¼š

1. **å›æµ‹æ¦‚è§ˆ** - å…³é”®æŒ‡æ ‡çš„å¯è§†åŒ–å±•ç¤º
2. **ç­–ç•¥åŸç†** - è¯¦ç»†çš„ç­–ç•¥è¯´æ˜å’ŒåŸç†
3. **ç­–ç•¥å®ç°è¯¦è§£** - ä»£ç å®ç°å’Œè§£é‡Š
   - 3.1 ç­–ç•¥æ ¸å¿ƒé€»è¾‘
   - 3.2 æŠ€æœ¯æŒ‡æ ‡è®¡ç®—
   - 3.3 é£é™©æ§åˆ¶æœºåˆ¶
   - 3.4 å›æµ‹æ•°æ®è¯´æ˜
   - 3.5 äº¤æ˜“è¿‡ç¨‹é€»è¾‘è¯¦è§£
   - 3.6 è‚¡ç¥¨æ± åˆ†æ
4. **å›æµ‹ç»“æœåˆ†æ** - æ”¶ç›Šã€é£é™©ã€äº¤æ˜“åˆ†æ
5. **äº¤æ˜“ç»“æœæ·±å…¥åˆ†æä¸å»ºè®®** - æ·±åº¦åˆ†æå’Œæ”¹è¿›å»ºè®®
   - 5.1 äº¤æ˜“ç»“æœæ·±åº¦åˆ†æ
   - 5.2 ç­–ç•¥ä¼˜åŠ¿ä¸äº®ç‚¹
   - 5.3 ç­–ç•¥ä¸è¶³ä¸æ”¹è¿›ç©ºé—´
   - 5.4 æ”¹è¿›å»ºè®®
   - 5.5 å®ç›˜åº”ç”¨å»ºè®®
   - 5.6 äº¤æ˜“å…¬å¸ç®€ä»‹ä¸è¡Œä¸šåˆ†æ
   - 5.7 é«˜å¢é•¿æ¿å—æŠ•èµ„å»ºè®®ä¸ç­–ç•¥ä¼˜åŒ–
6. **å¯è§†åŒ–å›¾è¡¨** - èµ„äº§å˜åŒ–æ›²çº¿å›¾ã€æ”¶ç›Šåˆ†å¸ƒç­‰
7. **æ·±åº¦åˆ†æä¸è§£è¯»** - ç­–ç•¥è¡¨ç°è§£è¯»

æŠ¥å‘Šç”Ÿæˆæ—¶ï¼Œå…ˆè°ƒç”¨ `utils/comprehensive_report_generator.py` è¾“å‡ºæ ‡å‡† HTMLï¼Œå†ç”± `utils/report_template_engine.py`ï¼ˆJinja2 åŒ…è£…å±‚ï¼‰æ³¨å…¥ä¸»é¢˜æ ·å¼ä¸é…ç½®è„šæœ¬ã€‚ä¸»æŠ¥å‘Šä¿å­˜åœ¨ `strategies/<ç­–ç•¥æ—>/backtests/<ç¼–å·_å…³é”®è¯_æ—¥æœŸ>/report.html`ï¼Œå¹¶è‡ªåŠ¨å¤åˆ¶ä¸€ä»½åˆ° `strategies/<ç­–ç•¥æ—>/reports/` ä»¥å…¼å®¹å¤–éƒ¨é“¾æ¥ã€‚

ç”Ÿæˆæµç¨‹ä¼šåœ¨å†™å…¥æŠ¥å‘Šå‰è°ƒç”¨ `utils/report_validators.evaluate_visualization_inputs`ï¼Œè‹¥å‘ç°å…³é”®æ•°æ®ç¼ºå¤±ï¼ˆä¾‹å¦‚å‡€å€¼åºåˆ—ä¸ºç©ºæˆ–äº¤æ˜“è®°å½•ç¼ºå¤±ï¼‰ï¼Œä¼šåœ¨æ—¥å¿—å’Œ `metadata.json` ä¸­è®°å½•å‘Šè­¦ï¼Œæ–¹ä¾¿å¿«é€Ÿæ’æŸ¥ã€‚æŠ¥å‘Šå‰ç«¯ä¹Ÿä¼šé€šè¿‡ `window.__REPORT_CONFIG__` åŠ¨æ€æ§åˆ¶ç« èŠ‚æ˜¾ç¤ºã€‚

### 5.3 æŸ¥çœ‹æŠ¥å‘Š

#### æ–¹å¼1ï¼šç›´æ¥æ‰“å¼€å›æµ‹ç›®å½•ä¸‹çš„æŠ¥å‘Šï¼ˆæ¨èï¼‰

```powershell
# æ‰“å¼€æœ€æ–°ç¼–å·çš„æŠ¥å‘Š
start strategies\adaptive_momentum_a\backtests\003_full_refresh_251109\report.html
```

æˆ–æŸ¥çœ‹å½’æ¡£å‰¯æœ¬ï¼š

```powershell
# æ‰“å¼€å½’æ¡£å‰¯æœ¬ï¼ˆå…¼å®¹æ—§å¤–é“¾ï¼‰
start strategies\adaptive_momentum_a\reports\adaptive_momentum_a_v2_v1.0_report_20251109_041734.html
```

#### æ–¹å¼2ï¼šä½¿ç”¨æŠ¥å‘ŠæŸ¥çœ‹å™¨

```powershell
# æ‰“å¼€æŠ¥å‘Šåˆ—è¡¨é¡µé¢
start results\view_report.html
```

æŠ¥å‘Šåˆ—è¡¨é¡µé¢ä¼šè‡ªåŠ¨æ‰«æ `strategies/*/backtests/` ä»¥åŠ `strategies/*/reports/` ä¸­çš„ HTML æŠ¥å‘Šï¼Œç‚¹å‡»å³å¯æŸ¥çœ‹ã€‚

#### æ–¹å¼3ï¼šé€šè¿‡Pythonè„šæœ¬

```python
from pathlib import Path
import webbrowser

# æ‰“å¼€æœ€æ–°æŠ¥å‘Š
report_files = sorted(Path("results").glob("*_report_*.html"), reverse=True)
if report_files:
    webbrowser.open(str(report_files[0]))
```

### 5.4 åˆ†ææŠ¥å‘Šå†…å®¹

**å…³é”®æŒ‡æ ‡è§£è¯»ï¼š**

- **æ€»æ”¶ç›Šç‡**: æ•´ä¸ªå›æµ‹æœŸé—´çš„æ€»æ”¶ç›Šç™¾åˆ†æ¯”
- **å¹´åŒ–æ”¶ç›Šç‡**: æ¢ç®—ä¸ºå¹´åŒ–çš„æ”¶ç›Šç‡
- **å¹´åŒ–æ³¢åŠ¨ç‡**: åºåˆ—æ ‡å‡†å·®å¹´åŒ–åçš„æ³¢åŠ¨æ°´å¹³ï¼Œè¡¡é‡å‡€å€¼æ›²çº¿çš„èµ·ä¼ç¨‹åº¦
- **å¤æ™®æ¯”ç‡**: é£é™©è°ƒæ•´åçš„æ”¶ç›ŠæŒ‡æ ‡ï¼ˆ>1ä¸ºè‰¯å¥½ï¼Œ>2ä¸ºä¼˜ç§€ï¼‰
- **Calmaræ¯”ç‡**: å¹´åŒ–æ”¶ç›Šç‡ä¸æœ€å¤§å›æ’¤çš„æ¯”å€¼ï¼Œåæ˜ æ”¶ç›Šä¸é£é™©çš„å¹³è¡¡ç¨‹åº¦
- **æœ€å¤§å›æ’¤**: ä»å³°å€¼åˆ°è°·å€¼çš„æœ€å¤§è·Œå¹…ï¼ˆè¶Šå°è¶Šå¥½ï¼‰
- **æ€»äº¤æ˜“æ¬¡æ•°**: ä¹°å…¥å’Œå–å‡ºçš„æ€»æ¬¡æ•°
- **èƒœç‡**: ç›ˆåˆ©äº¤æ˜“å æ€»äº¤æ˜“çš„æ¯”ä¾‹
- **å¹³å‡æŒä»“å¤©æ•°**: å¹³å‡æ¯ç¬”æŒä»“çš„æŒæœ‰æ—¶é—´
- **å¹´åŒ–æ¢æ‰‹ç‡**: äº¤æ˜“é‡‘é¢ä¸ç»„åˆè§„æ¨¡çš„æ¯”å€¼å¹´åŒ–ç»“æœï¼Œè¡¡é‡ç­–ç•¥è°ƒä»“å¼ºåº¦

**æŠ¥å‘Šåˆ†æè¦ç‚¹ï¼š**

1. **æ”¶ç›Šåˆ†æ**
   - æ˜¯å¦è·‘èµ¢åŸºå‡†ï¼Ÿ
   - æ”¶ç›Šæ˜¯å¦ç¨³å®šï¼Ÿ
   - æ˜¯å¦å­˜åœ¨å¼‚å¸¸æ”¶ç›Šï¼Ÿ

2. **é£é™©åˆ†æ**
   - æœ€å¤§å›æ’¤æ˜¯å¦å¯æ¥å—ï¼Ÿ
   - æ³¢åŠ¨ç‡æ˜¯å¦åˆç†ï¼Ÿ
   - é£é™©æ”¶ç›Šæ¯”æ˜¯å¦è‰¯å¥½ï¼Ÿ

3. **äº¤æ˜“åˆ†æ**
   - äº¤æ˜“é¢‘ç‡æ˜¯å¦åˆç†ï¼Ÿ
   - äº¤æ˜“æˆæœ¬å½±å“å¦‚ä½•ï¼Ÿ
   - æ˜¯å¦å­˜åœ¨è¿‡åº¦äº¤æ˜“ï¼Ÿ

4. **ç­–ç•¥åˆ†æ**
   - ç­–ç•¥é€»è¾‘æ˜¯å¦æœ‰æ•ˆï¼Ÿ
   - å‚æ•°è®¾ç½®æ˜¯å¦åˆç†ï¼Ÿ
   - æ˜¯å¦å­˜åœ¨æ”¹è¿›ç©ºé—´ï¼Ÿ

---

## 6. ç‰ˆæœ¬æ§åˆ¶ä¸ä»£ç ç®¡ç†

### 6.1 Gitå·¥ä½œæµç¨‹

#### åˆå§‹åŒ–ä»“åº“ï¼ˆé¦–æ¬¡ä½¿ç”¨ï¼‰

```powershell
# è¿›å…¥é¡¹ç›®ç›®å½•
cd C:\JQQuant

# åˆå§‹åŒ–Gitä»“åº“ï¼ˆå¦‚æœå°šæœªåˆå§‹åŒ–ï¼‰
git init

# æ·»åŠ è¿œç¨‹ä»“åº“
git remote add origin https://github.com/ZhuTechLLC/JQQuant.git
```

#### æ—¥å¸¸æäº¤æµç¨‹

**æ­¥éª¤1ï¼šæ£€æŸ¥æ›´æ”¹**

```powershell
# æŸ¥çœ‹æ›´æ”¹çŠ¶æ€
git status

# æŸ¥çœ‹å…·ä½“æ›´æ”¹å†…å®¹
git diff
```

**æ­¥éª¤2ï¼šæ·»åŠ æ–‡ä»¶åˆ°æš‚å­˜åŒº**

```powershell
# æ·»åŠ æ‰€æœ‰æ›´æ”¹
git add .

# æˆ–æ·»åŠ ç‰¹å®šæ–‡ä»¶
git add main.py
git add strategies/examples/my_strategy.py
```

**æ­¥éª¤3ï¼šæäº¤æ›´æ”¹**

```powershell
# ä½¿ç”¨è„šæœ¬æäº¤ï¼ˆæ¨èï¼Œè‡ªåŠ¨æ£€æŸ¥æ•æ„Ÿä¿¡æ¯ï¼‰
powershell -ExecutionPolicy Bypass -File git_commit.ps1

# æˆ–æ‰‹åŠ¨æäº¤
git commit -m "æè¿°æ‚¨çš„æ›´æ”¹"
```

**æ­¥éª¤4ï¼šæ¨é€åˆ°GitHub**

```powershell
# ä½¿ç”¨è„šæœ¬æ¨é€ï¼ˆæ¨èï¼Œè‡ªåŠ¨å¤„ç†è®¤è¯ï¼‰
powershell -ExecutionPolicy Bypass -File push_with_token.ps1 -Token "YOUR_GITHUB_TOKEN"

# æˆ–æ‰‹åŠ¨æ¨é€ï¼ˆéœ€è¦é…ç½®è®¤è¯ï¼‰
git push origin master
```

### 6.2 ä½¿ç”¨æ¨é€è„šæœ¬

#### å¿«é€Ÿæ¨é€

```powershell
# ä½¿ç”¨GitHub Personal Access Tokenæ¨é€
powershell -ExecutionPolicy Bypass -File push_with_token.ps1 -Token "ghp_xxxxxxxxxxxx"
```

**è„šæœ¬åŠŸèƒ½ï¼š**
- âœ… è‡ªåŠ¨åˆ·æ–°PATHç¯å¢ƒå˜é‡
- âœ… è‡ªåŠ¨æ£€æµ‹Gitå®‰è£…
- âœ… è‡ªåŠ¨é…ç½®Gitç”¨æˆ·ä¿¡æ¯ï¼ˆå¦‚æœæœªé…ç½®ï¼‰
- âœ… å®‰å…¨å¤„ç†Tokenï¼ˆä½¿ç”¨åæ¸…é™¤ï¼‰
- âœ… æ£€æŸ¥æ•æ„Ÿæ–‡ä»¶ï¼ˆç¡®ä¿ä¸æäº¤é…ç½®æ–‡ä»¶ï¼‰

#### è·å–GitHub Token

1. è®¿é—®ï¼šhttps://github.com/settings/tokens
2. ç‚¹å‡» "Generate new token (classic)"
3. é€‰æ‹©æƒé™ï¼š`repo`ï¼ˆå®Œæ•´ä»“åº“è®¿é—®æƒé™ï¼‰
4. ç”Ÿæˆå¹¶å¤åˆ¶Token
5. ä¿å­˜Tokenï¼ˆä¸è¦æäº¤åˆ°Gitä»“åº“ï¼ï¼‰

### 6.3 æ–‡ä»¶ç®¡ç†è§„åˆ™

#### å·²æ’é™¤çš„æ–‡ä»¶ï¼ˆ`.gitignore`ï¼‰

ä»¥ä¸‹æ–‡ä»¶/ç›®å½•ä¸ä¼šæäº¤åˆ°Gitï¼š

- `config/jqdata_config.json` - èšå®½è´¦å·å¯†ç 
- `data/` - æ•°æ®æ–‡ä»¶ï¼ˆå¯èƒ½å¾ˆå¤§ï¼‰
- `results/*.json` - JSONå›æµ‹æ•°æ®ï¼ˆå¯èƒ½å¾ˆå¤§ï¼‰
- `logs/` - æ—¥å¿—æ–‡ä»¶
- `__pycache__/` - Pythonç¼“å­˜
- `*.pyc` - ç¼–è¯‘æ–‡ä»¶
- `jqdata_env/` - è™šæ‹Ÿç¯å¢ƒ
- `github_token.txt` - GitHub Tokenæ–‡ä»¶

#### å·²åŒ…å«çš„æ–‡ä»¶

ä»¥ä¸‹æ–‡ä»¶ä¼šæäº¤åˆ°Gitï¼š

- âœ… æ‰€æœ‰Pythonæºä»£ç ï¼ˆ`.py`æ–‡ä»¶ï¼‰
- âœ… é…ç½®æ–‡ä»¶æ¨¡æ¿ï¼ˆ`config/example_*.json`ï¼‰
- âœ… HTMLæŠ¥å‘Šï¼ˆ`results/*.html`ï¼‰
- âœ… æ–‡æ¡£æ–‡ä»¶ï¼ˆ`.md`æ–‡ä»¶ï¼‰
- âœ… è„šæœ¬æ–‡ä»¶ï¼ˆ`.ps1`æ–‡ä»¶ï¼‰
- âœ… `requirements.txt`

### 6.4 æäº¤ä¿¡æ¯è§„èŒƒ

**æ¨èæ ¼å¼ï¼š**

```
<ç±»å‹>: <ç®€çŸ­æè¿°>

<è¯¦ç»†è¯´æ˜ï¼ˆå¯é€‰ï¼‰>
```

**ç±»å‹è¯´æ˜ï¼š**

- `feat`: æ–°åŠŸèƒ½
- `fix`: ä¿®å¤bug
- `docs`: æ–‡æ¡£æ›´æ–°
- `style`: ä»£ç æ ¼å¼è°ƒæ•´
- `refactor`: ä»£ç é‡æ„
- `test`: æµ‹è¯•ç›¸å…³
- `chore`: æ„å»º/å·¥å…·ç›¸å…³

**ç¤ºä¾‹ï¼š**

```powershell
git commit -m "feat: æ·»åŠ æ–°çš„è‡ªé€‚åº”åŠ¨é‡ç­–ç•¥v2.0

- å®ç°åŠ¨æ€å¸‚åœºçŠ¶æ€æ£€æµ‹
- æ·»åŠ è‡ªé€‚åº”å‚æ•°è°ƒæ•´
- ä¼˜åŒ–é£é™©æ§åˆ¶æœºåˆ¶
- æ›´æ–°æŠ¥å‘Šç”Ÿæˆå™¨ä»¥æ”¯æŒæ–°ç­–ç•¥"
```

### 6.5 åˆ†æ”¯ç®¡ç†ï¼ˆå¯é€‰ï¼‰

å¯¹äºå¤§å‹é¡¹ç›®ï¼Œå»ºè®®ä½¿ç”¨åˆ†æ”¯ï¼š

```powershell
# åˆ›å»ºæ–°åˆ†æ”¯
git checkout -b feature/new-strategy

# åœ¨æ–°åˆ†æ”¯ä¸Šå¼€å‘
# ... è¿›è¡Œæ›´æ”¹ ...

# æäº¤æ›´æ”¹
git add .
git commit -m "feat: æ·»åŠ æ–°ç­–ç•¥"

# åˆ‡æ¢å›ä¸»åˆ†æ”¯
git checkout master

# åˆå¹¶åˆ†æ”¯
git merge feature/new-strategy

# åˆ é™¤åˆ†æ”¯
git branch -d feature/new-strategy
```

---

## 7. æŒç»­ä¼˜åŒ–ä¸æ”¹è¿›

### 7.1 å‚æ•°ä¼˜åŒ–

#### æ‰‹åŠ¨å‚æ•°è°ƒä¼˜

1. **ç¡®å®šå‚æ•°èŒƒå›´**
   - æ ¹æ®ç­–ç•¥é€»è¾‘ç¡®å®šæ¯ä¸ªå‚æ•°çš„åˆç†èŒƒå›´
   - ä¾‹å¦‚ï¼šå‡çº¿å‘¨æœŸé€šå¸¸åœ¨5-60ä¹‹é—´

2. **ç½‘æ ¼æœç´¢**
   - éå†å‚æ•°ç»„åˆ
   - è®°å½•æ¯ä¸ªç»„åˆçš„å›æµ‹ç»“æœ
   - é€‰æ‹©æœ€ä¼˜å‚æ•°ç»„åˆ

3. **éªŒè¯æœ€ä¼˜å‚æ•°**
   - ä½¿ç”¨æ ·æœ¬å¤–æ•°æ®éªŒè¯
   - æ£€æŸ¥å‚æ•°ç¨³å®šæ€§

#### ç¤ºä¾‹ï¼šå‚æ•°ä¼˜åŒ–è„šæœ¬

```python
from main import run_backtest
import itertools

# å‚æ•°èŒƒå›´
short_windows = [5, 10, 15, 20]
long_windows = [20, 30, 40, 50]

best_result = None
best_params = None
best_return = -float('inf')

# éå†æ‰€æœ‰å‚æ•°ç»„åˆ
for short, long in itertools.product(short_windows, long_windows):
    if short >= long:
        continue
    
    results = run_backtest(
        strategy_name='ma_cross',
        start_date='2020-01-01',
        end_date='2023-12-31',
        securities=['000001.XSHE'],
        strategy_params={
            'short_window': short,
            'long_window': long
        }
    )
    
    if results:
        annual_return = results['metrics']['annual_return']
        if annual_return > best_return:
            best_return = annual_return
            best_params = {'short_window': short, 'long_window': long}
            best_result = results

print(f"æœ€ä¼˜å‚æ•°: {best_params}")
print(f"æœ€ä¼˜å¹´åŒ–æ”¶ç›Š: {best_return*100:.2f}%")
```

### 7.2 ç­–ç•¥æ”¹è¿›

#### æ”¹è¿›æ–¹å‘

1. **æŠ€æœ¯æŒ‡æ ‡ä¼˜åŒ–**
   - æ·»åŠ æ›´å¤šæŠ€æœ¯æŒ‡æ ‡
   - ä¼˜åŒ–æŒ‡æ ‡å‚æ•°
   - ç»„åˆå¤šä¸ªæŒ‡æ ‡

2. **é£é™©æ§åˆ¶å¢å¼º**
   - æ·»åŠ æ­¢æŸ/æ­¢ç›ˆæœºåˆ¶
   - åŠ¨æ€ä»“ä½ç®¡ç†
   - å¸‚åœºçŠ¶æ€è¯†åˆ«

3. **äº¤æ˜“é€»è¾‘ä¼˜åŒ–**
   - ä¼˜åŒ–ä¹°å–æ—¶æœº
   - å‡å°‘äº¤æ˜“é¢‘ç‡
   - é™ä½äº¤æ˜“æˆæœ¬

4. **æ•°æ®è´¨é‡æå‡**
   - æ•°æ®æ¸…æ´—
   - å¼‚å¸¸å€¼å¤„ç†
   - æ•°æ®éªŒè¯

#### æ”¹è¿›æµç¨‹

1. **é—®é¢˜è¯†åˆ«**
   - åˆ†æå›æµ‹ç»“æœ
   - è¯†åˆ«ç­–ç•¥å¼±ç‚¹
   - ç¡®å®šæ”¹è¿›æ–¹å‘

2. **æ–¹æ¡ˆè®¾è®¡**
   - è®¾è®¡æ”¹è¿›æ–¹æ¡ˆ
   - è¯„ä¼°å¯è¡Œæ€§
   - åˆ¶å®šå®æ–½è®¡åˆ’

3. **å®æ–½æ”¹è¿›**
   - ä¿®æ”¹ç­–ç•¥ä»£ç 
   - æ›´æ–°å‚æ•°é…ç½®
   - æ·»åŠ æ–°åŠŸèƒ½

4. **éªŒè¯æ•ˆæœ**
   - è¿è¡Œå›æµ‹
   - å¯¹æ¯”æ”¹è¿›å‰å
   - è¯„ä¼°æ”¹è¿›æ•ˆæœ

5. **æ–‡æ¡£æ›´æ–°**
   - æ›´æ–°ç­–ç•¥è¯´æ˜
   - è®°å½•æ”¹è¿›å†…å®¹
   - æ›´æ–°ä½¿ç”¨æ–‡æ¡£

### 7.3 æ€§èƒ½ç›‘æ§

#### å…³é”®æŒ‡æ ‡ç›‘æ§

å®šæœŸç›‘æ§ä»¥ä¸‹æŒ‡æ ‡ï¼š

- **å›æµ‹é€Ÿåº¦**: æ¯æ¬¡å›æµ‹çš„æ‰§è¡Œæ—¶é—´
- **æ•°æ®è·å–é€Ÿåº¦**: APIå“åº”æ—¶é—´
- **å†…å­˜ä½¿ç”¨**: å†…å­˜å ç”¨æƒ…å†µ
- **é”™è¯¯ç‡**: å›æµ‹å¤±è´¥çš„æ¯”ä¾‹

#### ä¼˜åŒ–å»ºè®®

- **æ•°æ®ç¼“å­˜**: ç¼“å­˜å¸¸ç”¨æ•°æ®ï¼Œå‡å°‘APIè°ƒç”¨
- **å¹¶è¡Œå¤„ç†**: ä½¿ç”¨å¤šè¿›ç¨‹/å¤šçº¿ç¨‹åŠ é€Ÿ
- **ä»£ç ä¼˜åŒ–**: ä¼˜åŒ–ç®—æ³•å’Œæ•°æ®ç»“æ„
- **èµ„æºç®¡ç†**: åŠæ—¶é‡Šæ”¾ä¸éœ€è¦çš„èµ„æº

---

## 8. å¸¸è§é—®é¢˜ä¸æ•…éšœæ’é™¤

### 8.1 è®¤è¯é—®é¢˜

**é—®é¢˜ï¼šèšå®½è®¤è¯å¤±è´¥**

**è§£å†³æ–¹æ¡ˆï¼š**

1. æ£€æŸ¥ `config/jqdata_config.json` ä¸­çš„è´¦å·å¯†ç 
2. ç¡®è®¤ç½‘ç»œè¿æ¥æ­£å¸¸
3. éªŒè¯èšå®½è´¦å·æ˜¯å¦æœ‰æ•ˆ
4. æŸ¥çœ‹æ—¥å¿—æ–‡ä»¶ `logs/jqquant.log` è·å–è¯¦ç»†é”™è¯¯

**æµ‹è¯•è®¤è¯ï¼š**

```python
from jqdata.client import JQDataClient
from config.config_manager import get_config_manager

config_manager = get_config_manager()
config = config_manager.get_jqdata_config()
jq_client = JQDataClient()

if jq_client.authenticate(config['username'], config['password']):
    print("è®¤è¯æˆåŠŸï¼")
else:
    print("è®¤è¯å¤±è´¥ï¼Œè¯·æ£€æŸ¥è´¦å·å¯†ç ")
```

### 8.2 æ•°æ®é—®é¢˜

**é—®é¢˜ï¼šæ•°æ®è·å–å¤±è´¥æˆ–æ•°æ®ä¸å®Œæ•´**

**è§£å†³æ–¹æ¡ˆï¼š**

1. æ£€æŸ¥è‚¡ç¥¨ä»£ç æ ¼å¼æ˜¯å¦æ­£ç¡®ï¼ˆå¦‚ `000001.XSHE`ï¼‰
2. ç¡®è®¤æ—¥æœŸèŒƒå›´æœ‰æ•ˆï¼ˆä¸èƒ½æ˜¯æœªæ¥æ—¥æœŸï¼‰
3. æ£€æŸ¥èšå®½è´¦å·æ˜¯å¦æœ‰æ•°æ®æƒé™
4. å°è¯•å•ä¸ªè‚¡ç¥¨ä»£ç æµ‹è¯•
5. æ£€æŸ¥è´¦å·æƒé™é™åˆ¶ï¼ˆæŸäº›è´¦å·æœ‰æ—¥æœŸèŒƒå›´é™åˆ¶ï¼‰

**æ£€æŸ¥æ•°æ®å¯ç”¨æ€§ï¼š**

```powershell
python check_date_range.py --start 2020-01-01 --end 2023-12-31 --securities 000001.XSHE
```

### 8.3 ç­–ç•¥æ‰§è¡Œé”™è¯¯

**é—®é¢˜ï¼šç­–ç•¥æ‰§è¡Œæ—¶å‡ºé”™**

**è§£å†³æ–¹æ¡ˆï¼š**

1. æŸ¥çœ‹æ—¥å¿—æ–‡ä»¶è·å–è¯¦ç»†é”™è¯¯ä¿¡æ¯
2. æ£€æŸ¥ç­–ç•¥ä»£ç é€»è¾‘
3. ç¡®ä¿æ•°æ®æ ¼å¼æ­£ç¡®
4. æ£€æŸ¥è®¢å•åˆ›å»ºé€»è¾‘
5. éªŒè¯æŒä»“ç®¡ç†

**è°ƒè¯•æŠ€å·§ï¼š**

```python
# åœ¨ç­–ç•¥ä¸­æ·»åŠ æ—¥å¿—
import logging
logger = logging.getLogger(__name__)

def handle_data(self, data: pd.DataFrame, date: datetime):
    logger.info(f"å¤„ç†æ—¥æœŸ: {date}")
    logger.debug(f"æ•°æ®: {data}")
    # ... ç­–ç•¥é€»è¾‘
```

### 8.4 å›æµ‹ç»“æœå¼‚å¸¸

**é—®é¢˜ï¼šå›æµ‹ç»“æœä¸åˆç†ï¼ˆå¦‚æ”¶ç›Šè¿‡é«˜ã€äº¤æ˜“æ¬¡æ•°å¼‚å¸¸ç­‰ï¼‰**

**å¯èƒ½åŸå› ï¼š**

1. ç­–ç•¥é€»è¾‘é”™è¯¯
2. æ•°æ®è´¨é‡é—®é¢˜
3. å‚æ•°è®¾ç½®ä¸åˆç†
4. è®¢å•æ‰§è¡Œé€»è¾‘é—®é¢˜

**è°ƒè¯•æ–¹æ³•ï¼š**

1. å‡å°‘å›æµ‹æ—¶é—´èŒƒå›´
2. ä½¿ç”¨å•ä¸ªè‚¡ç¥¨æµ‹è¯•
3. æ·»åŠ è¯¦ç»†æ—¥å¿—è¾“å‡º
4. æ£€æŸ¥è®¢å•æ‰§è¡Œæƒ…å†µ
5. éªŒè¯æŒä»“è®¡ç®—

### 8.5 Gitæ¨é€é—®é¢˜

**é—®é¢˜ï¼šGitæ¨é€å¤±è´¥**

**å¸¸è§é”™è¯¯ï¼š**

1. **Gitæœªæ‰¾åˆ°**
   - è§£å†³æ–¹æ¡ˆï¼šè¿è¡Œ `install_git.ps1` æˆ–æ‰‹åŠ¨å®‰è£…Git
   - æˆ–ä½¿ç”¨ `push_with_token.ps1` è„šæœ¬ï¼ˆè‡ªåŠ¨æ£€æµ‹Gitï¼‰

2. **è®¤è¯å¤±è´¥**
   - è§£å†³æ–¹æ¡ˆï¼šæ£€æŸ¥GitHub Tokenæ˜¯å¦æœ‰æ•ˆ
   - ç¡®è®¤Tokenæœ‰ `repo` æƒé™

3. **æ¨é€ä¿æŠ¤é”™è¯¯**
   - è§£å†³æ–¹æ¡ˆï¼šæ£€æŸ¥æ˜¯å¦åŒ…å«æ•æ„Ÿä¿¡æ¯ï¼ˆå¦‚Tokenã€å¯†ç ï¼‰
   - ç¡®ä¿ `.gitignore` æ­£ç¡®é…ç½®

4. **ç½‘ç»œé—®é¢˜**
   - è§£å†³æ–¹æ¡ˆï¼šæ£€æŸ¥ç½‘ç»œè¿æ¥
   - å°è¯•ä½¿ç”¨ä»£ç†æˆ–VPN

**ä½¿ç”¨æ¨é€è„šæœ¬ï¼ˆæ¨èï¼‰ï¼š**

```powershell
powershell -ExecutionPolicy Bypass -File push_with_token.ps1 -Token "YOUR_TOKEN"
```

### 8.6 æŠ¥å‘Šç”Ÿæˆé—®é¢˜

**é—®é¢˜ï¼šHTMLæŠ¥å‘Šç”Ÿæˆå¤±è´¥æˆ–æ˜¾ç¤ºå¼‚å¸¸**

**è§£å†³æ–¹æ¡ˆï¼š**

1. æ£€æŸ¥JSONç»“æœæ–‡ä»¶æ˜¯å¦å­˜åœ¨
2. éªŒè¯JSONæ–‡ä»¶æ ¼å¼æ˜¯å¦æ­£ç¡®
3. æŸ¥çœ‹æ—¥å¿—æ–‡ä»¶è·å–é”™è¯¯ä¿¡æ¯
4. ç¡®è®¤æ‰€æœ‰ä¾èµ–å·²å®‰è£…ï¼ˆpandas, plotlyç­‰ï¼‰

**æ‰‹åŠ¨ç”ŸæˆæŠ¥å‘Šï¼š**

```python
from utils.comprehensive_report_generator import generate_comprehensive_html_report
import json
from pathlib import Path

# åŠ è½½ç»“æœ
results_file = Path("results/backtest_xxx.json")
with open(results_file, 'r', encoding='utf-8') as f:
    results = json.load(f)

# ç”ŸæˆæŠ¥å‘Š
generate_comprehensive_html_report(results, output_path=Path("results/report.html"))
```

---

## ğŸ“š é™„å½•

### A. å¿«é€Ÿå‚è€ƒå‘½ä»¤

```powershell
# è¿è¡Œå›æµ‹
python main.py --strategy adaptive_momentum_a_v2 --start 2020-01-01 --end 2023-12-31 --securities 000001.XSHE

# æ£€æŸ¥æ•°æ®
python check_date_range.py --start 2020-01-01 --end 2023-12-31 --securities 000001.XSHE

# æµ‹è¯•å¯¼å…¥
python test_imports.py

# Gitæäº¤
powershell -ExecutionPolicy Bypass -File git_commit.ps1

# Gitæ¨é€
powershell -ExecutionPolicy Bypass -File push_with_token.ps1 -Token "YOUR_TOKEN"

# æŸ¥çœ‹æ—¥å¿—
Get-Content logs\jqquant.log -Tail 50
```

### B. é‡è¦æ–‡ä»¶ä½ç½®

- **ä¸»å…¥å£**: `main.py`
- **é…ç½®æ–‡ä»¶**: `config/jqdata_config.json`
- **è‚¡ç¥¨æ± **: `config/stock_pool.json`
- **ç­–ç•¥ç›®å½•**: `strategies/examples/`
- **ç»“æœç›®å½•**: `results/`
- **æ—¥å¿—æ–‡ä»¶**: `logs/jqquant.log`
- **æŠ¥å‘Šç”Ÿæˆå™¨**: `utils/comprehensive_report_generator.py`

### C. ç›¸å…³æ–‡æ¡£

- `README.md` - é¡¹ç›®æ¦‚è¿°
- `QUICK_START.md` - å¿«é€Ÿå¼€å§‹æŒ‡å—
- `USAGE_TUTORIAL.md` - è¯¦ç»†ä½¿ç”¨æ•™ç¨‹
- `IMPLEMENTATION_PLAN.md` - å®æ–½è®¡åˆ’
- `GIT_COMMIT_GUIDE.md` - Gitæäº¤æŒ‡å—
- `results/README.md` - æŠ¥å‘Šä½¿ç”¨è¯´æ˜

### D. å¤–éƒ¨èµ„æº

- **èšå®½APIæ–‡æ¡£**: https://www.joinquant.com/help/api/help
- **èšå®½æ•°æ®å¹³å°**: https://www.joinquant.com/
- **GitHubä»“åº“**: https://github.com/ZhuTechLLC/JQQuant

---

## âœ… å·¥ä½œæµç¨‹æ£€æŸ¥æ¸…å•

### é¦–æ¬¡ä½¿ç”¨

- [ ] å®‰è£…Pythonä¾èµ–
- [ ] é…ç½®èšå®½è´¦å·
- [ ] éªŒè¯å®‰è£…ï¼ˆè¿è¡Œ `test_imports.py`ï¼‰
- [ ] è¿è¡Œç¤ºä¾‹å›æµ‹
- [ ] æŸ¥çœ‹å›æµ‹ç»“æœå’ŒæŠ¥å‘Š
- [ ] é…ç½®Gitï¼ˆå¯é€‰ï¼‰

### æ—¥å¸¸ä½¿ç”¨

- [ ] å¼€å‘/ä¿®æ”¹ç­–ç•¥
- [ ] é…ç½®è‚¡ç¥¨æ± 
- [ ] è¿è¡Œå›æµ‹
- [ ] åˆ†æç»“æœ
- [ ] æŸ¥çœ‹HTMLæŠ¥å‘Š
- [ ] ä¼˜åŒ–ç­–ç•¥å‚æ•°
- [ ] æäº¤ä»£ç æ›´æ”¹ï¼ˆå¦‚éœ€è¦ï¼‰
- [ ] æ¨é€åˆ°GitHubï¼ˆå¦‚éœ€è¦ï¼‰

### ç­–ç•¥ä¼˜åŒ–

- [ ] åˆ†æå›æµ‹ç»“æœ
- [ ] è¯†åˆ«æ”¹è¿›ç‚¹
- [ ] å®æ–½æ”¹è¿›
- [ ] éªŒè¯æ•ˆæœ
- [ ] æ›´æ–°æ–‡æ¡£

---

**ç¥æ‚¨ä½¿ç”¨æ„‰å¿«ï¼å¦‚æœ‰é—®é¢˜ï¼Œè¯·æŸ¥çœ‹æ—¥å¿—æ–‡ä»¶æˆ–ç›¸å…³æ–‡æ¡£ã€‚**

<!-- AUTO_WORKFLOW_SUMMARY:START -->
### è‡ªåŠ¨å›æµ‹ä¸æŠ¥å‘Šå·¥ä½œæµ

ä½¿ç”¨è„šæœ¬å¯ä¸€é”®å®Œæˆå›æµ‹ã€æŠ¥å‘Šç”Ÿæˆã€å¯è§†åŒ–æ ¡éªŒä¸æ–‡æ¡£åŒæ­¥ï¼š
```powershell
python scripts/run_report_workflow.py \
  --strategy energy_storage_leaders \
  --keyword full_refresh \
  --start 2024-08-01 --end 2024-10-31 \
  --stock-pool-key high_growth_stocks
```

| Run ID | Strategy | Keyword | Date Range | Total Return | Annual Return | Sharpe | Max DD |
| --- | --- | --- | --- | --- | --- | --- | --- |
| 000 | energy_storage_leaders | energy_storage_demo | 2024-08-15 ~ 2025-08-08 | N/A | N/A | N/A | N/A |
<!-- AUTO_WORKFLOW_SUMMARY:END -->

### è´¨é‡ä¿éšœï¼ˆQAï¼‰æ¸…å•

- **åç«¯**
  - è¿è¡Œå•å…ƒæµ‹è¯•ï¼š`python -m pytest`
  - å¯é€‰é™æ€æ£€æŸ¥ï¼š`ruff check`ã€`black --check`ï¼ˆéœ€äº‹å…ˆå®‰è£…å¯¹åº”å·¥å…·ï¼‰
  - é‡è¦å­—æ®µå›å½’ï¼šç¡®è®¤æœ€æ–° `metrics.json` å¸¦æœ‰ `trade_summary` / `return_summary`
- **å‰ç«¯**
  - ç±»å‹æ£€æŸ¥ + æ„å»ºï¼š`cd ui/dashboard && npm run build`
  - å¼€å‘éªŒè¯ï¼š`npm run dev`ï¼Œæµè§ˆå™¨è®¿é—® `http://localhost:5174` æ£€æŸ¥ä»ªè¡¨ç›˜ã€å·¥ä½œæµæ—¶é—´çº¿
  - å¦‚å¯ç”¨ ESLint / Vitestï¼Œå¯çº¦å®š `npm run lint`ã€`npm run test`
- **å‘å¸ƒå‰ç¡®è®¤**
  - FastAPI å¥åº·æ£€æŸ¥ï¼š`curl http://127.0.0.1:9100/health`
  - è‡ªåŠ©æ–‡æ¡£åŒæ­¥ï¼šç¡®ä¿æœ¬æ–‡ä»¶ä¸ä»ªè¡¨ç›˜æ–‡æ¡ˆä¸€è‡´ï¼Œ`AUTO_WORKFLOW_SUMMARY` æ•°æ®ä¸ºæœ€æ–°è¿è¡Œ
  - è®°å½•æœ¬æ¬¡å›æµ‹/éƒ¨ç½²ç»“æœï¼Œå½’æ¡£ç¤ºä¾‹æŠ¥å‘Šä¾¿äºå®¡è®¡
