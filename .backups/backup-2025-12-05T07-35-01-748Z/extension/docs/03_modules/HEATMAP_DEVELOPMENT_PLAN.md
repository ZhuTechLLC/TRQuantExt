# 热度评分系统开发计划

## ✅ 开发完成！

**完成时间**: 2024年11月28日

## 📋 基于《市场主线识别模块之热度评分设计方案.pdf》

### 🎯 开发目标

根据专业设计方案，开发完整的热度评分系统，包括：
1. 主线热度评分（7个因子）
2. 个股热度评分（8个因子）
3. 与主线识别模块的深度融合
4. 短中长期主线分类输出

---

## 📊 主线热度评分设计

### 7个热度因子

| 因子 | 权重 | 数据来源 | 标准化方法 | 时间窗口 |
|------|------|----------|------------|----------|
| 新闻数量 | 20% | 财经资讯数据库 | Min-Max归一化 | 7日，指数衰减 |
| 关键词提及 | 10% | 新闻/研报/社交 | 对数缩放+Min-Max | 7-15日，指数衰减 |
| 搜索指数 | 10% | 百度/谷歌趋势 | 百分比归一化 | 7日平均 |
| 研报覆盖度 | 15% | 研报数据库 | Z-Score相对历史 | 30日，无需强衰减 |
| 社交媒体传播度 | 15% | 微博/微信/股吧 | 多源汇总+Min-Max | 7日，快速衰减 |
| 龙虎榜次数 | 15% | 交易所龙虎榜 | 对比全市场Max | 5日，快速衰减 |
| 涨停股数量 | 15% | 行情数据统计 | 对比全板块Max | 5日，快速衰减 |

### 综合评分权重调整

**原设计**（pro_engine.py）:
- 资金 25% + 动量 20% + 热度 20% + 政策 20% + 龙头 15%

**新设计**（根据PDF）:
- 热度 30% + 资金 25% + 趋势 25% + 政策 20%

**注意**: 需要将"动量"和"龙头"整合到"趋势"中

---

## 📊 个股热度评分设计

### 8个热度因子

| 因子 | 权重 | 说明 |
|------|------|------|
| 主线热度 | 15% | 所属主题热度评分 |
| 公司新闻数 | 15% | 媒体曝光度 |
| 龙虎榜次数 | 15% | 游资关注度 |
| 涨停次数 | 15% | 资金追捧度 |
| 热点概念重合度 | 10% | 题材叠加效应 |
| 板块热度占比 | 10% | 板块领军性 |
| 股吧/雪球提及数 | 10% | 散户讨论热度 |
| 估值提升热度 | 10% | 炒作溢价度 |

---

## 🏗️ 架构设计

### 模块结构

```
markets/ashare/mainline/
├── pro_engine.py              # 主线识别引擎（需优化）
├── heatmap_engine.py          # 热度评分引擎（新建）
├── stock_heatmap_engine.py    # 个股热度评分引擎（新建）
├── heatmap_data_fetcher.py    # 热度数据获取器（新建）
└── report_generator.py        # 报告生成器（需扩展）

gui/widgets/
├── pro_mainline_panel.py      # 专业主线面板（需优化）
└── heatmap_panel.py           # 热度评分面板（需增强）
```

### 数据流

```
数据获取 → 因子计算 → 标准化 → 加权合成 → 时间衰减 → 热度评分
    ↓
主线识别引擎 → 综合评分（热度30%+资金25%+趋势25%+政策20%）
    ↓
短中长期分类 → 输出结果
```

---

## 📝 开发步骤

### 阶段1: 热度评分引擎（核心）🔥 Max Mode

1. **heatmap_engine.py** - 核心引擎
   - 7个因子计算
   - 标准化方法实现
   - 权重合成
   - 时间衰减处理

2. **heatmap_data_fetcher.py** - 数据获取
   - 新闻数量获取
   - 搜索指数获取（预留）
   - 研报数据获取（预留）
   - 社交媒体数据（预留）
   - 龙虎榜数据（已有）
   - 涨停数据（已有）

### 阶段2: 集成优化 ⚡ Auto Mode

3. **pro_engine.py优化**
   - 调整综合评分权重
   - 集成热度评分引擎
   - 短中长期主线分类

4. **pro_mainline_panel.py优化**
   - 显示热度评分详情
   - 热度趋势图表
   - 因子拆解视图

### 阶段3: 个股热度评分 ⚡ Auto Mode

5. **stock_heatmap_engine.py**
   - 8个因子计算
   - 个股热度排名

6. **GUI集成**
   - 个股热度列表
   - 龙头股筛选

### 阶段4: 报告和UI ⚡ Auto Mode

7. **报告生成器扩展**
   - 热度评分报告
   - 轮动趋势图

8. **heatmap_panel.py增强**
   - 热度排名图表
   - 轮动趋势可视化
   - 一键回测链接

---

## 🔧 技术要点

### 标准化方法

1. **Min-Max归一化**: `(x - min) / (max - min) * 100`
2. **对数缩放**: `log(x + 1)` 后Min-Max
3. **Z-Score标准化**: `(x - mean) / std`
4. **指数衰减**: `w(t) = e^(-λ * Δt)`

### 时间窗口

- **短期**: 3-5日，快速衰减
- **中期**: 15-30日，中等衰减
- **长期**: 60-180日，平滑处理

---

## 📊 数据源优先级

### 已有数据源（可直接使用）
- ✅ 龙虎榜数据（real_data_fetcher.py）
- ✅ 涨停数据（real_data_fetcher.py）
- ✅ 板块资金流向（real_data_fetcher.py）

### 需要新增数据源
- ⏳ 新闻数量（需要新闻API或爬虫）
- ⏳ 搜索指数（百度指数API，需申请）
- ⏳ 研报数据（需要研报数据库）
- ⏳ 社交媒体（微博/股吧API，需申请）

### 实现策略
1. **第一阶段**: 使用已有数据（龙虎榜、涨停）+ 模拟数据
2. **第二阶段**: 逐步接入真实数据源
3. **预留接口**: 为未来数据源预留接口

---

## 🎯 下一步行动

1. **切换到 Max Mode** - 设计核心算法
2. **创建 heatmap_engine.py** - 实现7因子评分引擎
3. **优化 pro_engine.py** - 集成热度评分
4. **创建数据获取器** - 扩展heatmap_data_fetcher.py
5. **GUI集成** - 增强现有面板

---

*开发计划基于《市场主线识别模块之热度评分设计方案.pdf》*

