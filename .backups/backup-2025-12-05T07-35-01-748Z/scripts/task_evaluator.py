#!/usr/bin/env python3
"""
ä»»åŠ¡å¤æ‚åº¦è¯„ä¼°å·¥å…·
å¿«é€Ÿè¯„ä¼°ä»»åŠ¡åº”è¯¥ä½¿ç”¨å“ªä¸ªAIæ¨¡å‹

é»˜è®¤æ¨¡å¼: Auto Mode (Claude Sonnet)
å¦‚æœè¯„ä¼°å»ºè®®ç”¨Autoï¼Œå¯ä»¥ç›´æ¥ç»§ç»­
å¦‚æœéœ€è¦Max Modeï¼Œä¼šç»™å‡ºæ˜ç¡®æ¨è

ä½¿ç”¨æ–¹æ³•:
    python scripts/task_evaluator.py
    æˆ–åœ¨Cursorä¸­ç›´æ¥è¿è¡Œ
"""

def evaluate_task(task_description=None):
    """è¯„ä¼°ä»»åŠ¡å¤æ‚åº¦å¹¶ç»™å‡ºæ¨¡å‹æ¨è"""
    
    print("\n" + "="*70)
    print("ğŸ¤– AIæ¨¡å‹æ™ºèƒ½é€‰æ‹©åŠ©æ‰‹")
    print("="*70)
    
    # å¦‚æœæä¾›äº†ä»»åŠ¡æè¿°ï¼Œæ˜¾ç¤ºå®ƒ
    if task_description:
        print(f"\nğŸ“‹ ä»»åŠ¡: {task_description}\n")
    
    print("ğŸ’¡ é»˜è®¤æ¨¡å¼: Auto Mode (Claude Sonnet)")
    print("   å¦‚æœè¯„ä¼°å»ºè®®ç”¨Autoï¼Œå¯ä»¥ç›´æ¥ç»§ç»­å¼€å‘")
    print("   å¦‚æœéœ€è¦Max Modeï¼Œä¼šç»™å‡ºæ˜ç¡®æ¨è\n")
    print("-"*70)
    
    questions = [
        ("æ˜¯å¦æ¶‰åŠç³»ç»Ÿæ¶æ„è®¾è®¡ï¼Ÿ", 3, "æ¶æ„è®¾è®¡"),
        ("æ˜¯å¦éœ€è¦è®¾è®¡æ–°ç®—æ³•æˆ–å¤æ‚é€»è¾‘ï¼Ÿ", 3, "ç®—æ³•å¼€å‘"),
        ("æ˜¯å¦è·¨è¶Šå¤šä¸ªæ¨¡å—/æ–‡ä»¶ï¼ˆ>3ä¸ªï¼‰ï¼Ÿ", 2, "å¤šæ¨¡å—"),
        ("æ˜¯å¦æ˜¯ä»é›¶å¼€å§‹çš„æ–°åŠŸèƒ½ï¼Ÿ", 2, "æ–°åŠŸèƒ½"),
        ("æ˜¯å¦æ¶‰åŠç–‘éš¾Bugæˆ–æ€§èƒ½ä¼˜åŒ–ï¼Ÿ", 2, "ç–‘éš¾é—®é¢˜"),
        ("æ˜¯å¦éœ€è¦ç†è§£å¤æ‚ä¸šåŠ¡é€»è¾‘ï¼Ÿ", 1, "å¤æ‚é€»è¾‘"),
        ("æ˜¯å¦æ¶‰åŠæ•°æ®åº“æˆ–APIè®¾è®¡ï¼Ÿ", 1, "æ•°æ®è®¾è®¡"),
    ]
    
    total_score = 0
    checked_items = []
    
    print("\nè¯·å›ç­”ä»¥ä¸‹é—®é¢˜ (y/nï¼Œç›´æ¥å›è½¦é»˜è®¤n):\n")
    
    for i, (question, weight, tag) in enumerate(questions, 1):
        while True:
            answer = input(f"  {i}. {question} ").strip().lower()
            if answer in ['y', 'yes', 'æ˜¯', '1']:
                total_score += weight
                checked_items.append(tag)
                break
            elif answer in ['n', 'no', 'å¦', '0', '']:
                break
            else:
                print("     è¯·è¾“å…¥ y æˆ– n (æˆ–ç›´æ¥å›è½¦)")
    
    print("\n" + "-"*70)
    print(f"ğŸ“Š å¤æ‚åº¦è¯„åˆ†: {total_score}/14")
    if checked_items:
        print(f"   è§¦å‘é¡¹: {', '.join(checked_items)}")
    print("-"*70)
    
    # è¯„ä¼°ç»“æœ
    if total_score >= 8:
        recommendation = """
ğŸ”¥ å¼ºçƒˆæ¨è: Max Mode (Claude Opus 4.5)

åŸå› : ä»»åŠ¡å¤æ‚åº¦é«˜ï¼Œéœ€è¦æœ€å¼ºå¤§çš„æ¨¡å‹
- æ¶æ„è®¾è®¡èƒ½åŠ›
- å¤æ‚ç®—æ³•ç†è§£
- å¤šæ–‡ä»¶å…³è”åˆ†æ
- æ·±åº¦é—®é¢˜è§£å†³

âš ï¸  é‡è¦: è¯·åœ¨Cursorä¸­åˆ‡æ¢åˆ° Max Mode åå†ç»§ç»­
   è¿™ç±»ä»»åŠ¡å€¼å¾—ä½¿ç”¨Max Modeï¼Œç¡®ä¿è´¨é‡

ğŸ’¡ æç¤º: å¦‚æœAuto Modeæ— æ³•è§£å†³ï¼Œå†å‡çº§åˆ°Max Mode
"""
        model = "max"
        action = "è¯·åˆ‡æ¢åˆ° Max Mode"
        
    elif total_score >= 4:
        recommendation = """
âœ… æ¨è: Auto Mode (Claude Sonnet) - é»˜è®¤æ¨¡å¼

åŸå› : ä»»åŠ¡ä¸­ç­‰å¤æ‚åº¦ï¼ŒAuto Modeå¯ä»¥èƒœä»»
- åŠŸèƒ½å®ç°
- å¸¸è§„Bugä¿®å¤
- æ–‡æ¡£ç¼–å†™
- UIè°ƒæ•´

âœ… å¯ä»¥ç›´æ¥ç»§ç»­å¼€å‘ï¼Œä½¿ç”¨é»˜è®¤çš„ Auto Mode

ğŸ’¡ æç¤º: å¦‚æœé‡åˆ°å›°éš¾ï¼Œå¯ä»¥å‡çº§åˆ° Max Mode
"""
        model = "auto"
        action = "å¯ä»¥ç›´æ¥ç»§ç»­ï¼Œä½¿ç”¨ Auto Mode"
        
    else:
        recommendation = """
âœ… æ¨è: Auto Mode (Claude Sonnet) - é»˜è®¤æ¨¡å¼

åŸå› : ä»»åŠ¡ç›¸å¯¹ç®€å•ï¼ŒAuto Modeå®Œå…¨å¤Ÿç”¨
- å°ä¿®æ”¹
- ä»£ç æ ¼å¼åŒ–
- ç®€å•é—®ç­”
- æ–‡ä»¶æ“ä½œ

âœ… å¯ä»¥ç›´æ¥ç»§ç»­å¼€å‘ï¼Œä½¿ç”¨é»˜è®¤çš„ Auto Mode

ğŸ’¡ æç¤º: å¦‚æœåªæ˜¯éå¸¸ç®€å•çš„ä»»åŠ¡ï¼Œä¹Ÿå¯ä»¥å°è¯• Fast Mode
"""
        model = "auto"
        action = "å¯ä»¥ç›´æ¥ç»§ç»­ï¼Œä½¿ç”¨ Auto Mode"
    
    print(recommendation)
    print("="*70)
    
    # è¿”å›ç»“æœ
    return {
        "score": total_score,
        "model": model,
        "action": action,
        "checked_items": checked_items
    }


def quick_guide():
    """å¿«é€Ÿå‚è€ƒæŒ‡å—"""
    
    guide = """
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘              ğŸ¤– AIæ¨¡å‹å¿«é€Ÿé€‰æ‹©æŒ‡å—                            â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘                                                              â•‘
â•‘  ğŸ“Œ é»˜è®¤æ¨¡å¼: Auto Mode (Claude Sonnet)                      â•‘
â•‘     å¤§éƒ¨åˆ†ä»»åŠ¡éƒ½å¯ä»¥ç”¨Auto Modeå®Œæˆ                          â•‘
â•‘                                                              â•‘
â•‘  ğŸ”¥ Max Mode (Claude Opus 4.5) - å¤æ‚ä»»åŠ¡                   â•‘
â•‘  â”œâ”€ æ¶æ„è®¾è®¡ã€ç®—æ³•å¼€å‘                                       â•‘
â•‘  â”œâ”€ ç–‘éš¾Bugã€å¤§è§„æ¨¡é‡æ„                                      â•‘
â•‘  â”œâ”€ æ–¹æ¡ˆç”Ÿæˆã€åˆ›æ–°åŠŸèƒ½                                       â•‘
â•‘  â””â”€ å¤šæ¨¡å—å…³è”çš„å¤æ‚é—®é¢˜                                     â•‘
â•‘                                                              â•‘
â•‘  âš¡ Auto Mode (Claude Sonnet) - é»˜è®¤æ¨¡å¼                      â•‘
â•‘  â”œâ”€ åŠŸèƒ½å®ç°ã€å¸¸è§„Bug                                        â•‘
â•‘  â”œâ”€ æ–‡æ¡£ç¼–å†™ã€æµ‹è¯•ç¼–å†™                                       â•‘
â•‘  â”œâ”€ UIè°ƒæ•´ã€æ•°æ®å¤„ç†                                         â•‘
â•‘  â””â”€ æŒ‰å·²æœ‰æ¨¡å¼å¼€å‘                                           â•‘
â•‘                                                              â•‘
â•‘  âš¡âš¡ Fast Mode (Claude Haiku) - ç®€å•ä»»åŠ¡                     â•‘
â•‘  â”œâ”€ å°ä¿®æ”¹ã€æ ¼å¼åŒ–                                           â•‘
â•‘  â”œâ”€ ä»£ç æŸ¥è¯¢ã€ç®€å•é—®ç­”                                       â•‘
â•‘  â””â”€ æ–‡ä»¶æ“ä½œã€å˜é‡é‡å‘½å                                     â•‘
â•‘                                                              â•‘
â•‘  ğŸ“ å…³äº Haiku:                                              â•‘
â•‘     Claude Haiku æ˜¯ Anthropic æœ€å¿«çš„æ¨¡å‹ï¼Œé€‚åˆç®€å•ä»»åŠ¡       â•‘
â•‘     åœ¨ Cursor ä¸­ï¼ŒFast Mode å¯èƒ½ä½¿ç”¨ Haiku æˆ–ç±»ä¼¼è½»é‡æ¨¡å‹   â•‘
â•‘                                                              â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘  ğŸ’¡ éŸ¬ç¿é‡åŒ–å¼€å‘å»ºè®®:                                        â•‘
â•‘                                                              â•‘
â•‘  Max Mode:  è¯„åˆ†å¼•æ“è®¾è®¡ã€å›æµ‹æ¶æ„ã€å¤šå¸‚åœºè®¾è®¡               â•‘
â•‘  Auto Mode: GUIå®ç°ã€æŠ¥å‘Šç”Ÿæˆã€æ•°æ®è·å–ã€æ–‡æ¡£ (é»˜è®¤)         â•‘
â•‘  Fast Mode: æ ·å¼å¾®è°ƒã€æ‹¼å†™ä¿®å¤ã€ç®€å•æŸ¥è¯¢                     â•‘
â•‘                                                              â•‘
â•‘  âš ï¸  æ³¨æ„: ç›®å‰ä¸æ”¯æŒè‡ªåŠ¨åˆ‡æ¢æ¨¡å¼                            â•‘
â•‘     éœ€è¦æ‰‹åŠ¨åœ¨ Cursor ä¸­åˆ‡æ¢ Max/Auto/Fast Mode             â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
"""
    print(guide)


def explain_haiku():
    """è§£é‡Š Haiku æ¨¡å‹"""
    
    explanation = """
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘              ğŸ“š å…³äº Claude Haiku æ¨¡å‹                        â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘                                                              â•‘
â•‘  Claude Haiku æ˜¯ Anthropic çš„ Claude æ¨¡å‹ç³»åˆ—ä¹‹ä¸€           â•‘
â•‘                                                              â•‘
â•‘  ç‰¹ç‚¹:                                                       â•‘
â•‘  â€¢ æœ€å¿«çš„å“åº”é€Ÿåº¦                                            â•‘
â•‘  â€¢ æœ€ä½çš„æˆæœ¬                                                â•‘
â•‘  â€¢ é€‚åˆç®€å•ã€é‡å¤æ€§ä»»åŠ¡                                       â•‘
â•‘                                                              â•‘
â•‘  é€‚ç”¨åœºæ™¯:                                                   â•‘
â•‘  â€¢ ä»£ç æ ¼å¼åŒ–ã€é£æ ¼ç»Ÿä¸€                                       â•‘
â•‘  â€¢ ç®€å•çš„å˜é‡é‡å‘½å                                          â•‘
â•‘  â€¢ æŸ¥æ‰¾ä»£ç ä½ç½®                                               â•‘
â•‘  â€¢ ç®€å•çš„é—®ç­”                                                â•‘
â•‘  â€¢ æ–‡ä»¶æ“ä½œï¼ˆç§»åŠ¨ã€é‡å‘½åï¼‰                                   â•‘
â•‘                                                              â•‘
â•‘  åœ¨ Cursor ä¸­:                                               â•‘
â•‘  â€¢ Fast Mode å¯èƒ½ä½¿ç”¨ Haiku æˆ–ç±»ä¼¼çš„è½»é‡æ¨¡å‹                â•‘
â•‘  â€¢ é€‚åˆå¿«é€Ÿå®Œæˆç®€å•ä»»åŠ¡                                       â•‘
â•‘                                                              â•‘
â•‘  ğŸ’¡ å¯¹äºéŸ¬ç¿é‡åŒ–å¼€å‘:                                         â•‘
â•‘     å¤§éƒ¨åˆ†ä»»åŠ¡ç”¨ Auto Mode (Sonnet) å³å¯                    â•‘
â•‘     åªæœ‰éå¸¸ç®€å•çš„æ ¼å¼åŒ–ã€æŸ¥è¯¢ä»»åŠ¡æ‰ç”¨ Fast Mode            â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
"""
    print(explanation)


if __name__ == "__main__":
    import sys
    
    if len(sys.argv) > 1:
        arg = sys.argv[1].lower()
        if arg in ['-g', '--guide', 'guide']:
            quick_guide()
        elif arg in ['-h', '--help', 'help']:
            print("\nä½¿ç”¨æ–¹æ³•:")
            print("  python scripts/task_evaluator.py          # è¯„ä¼°ä»»åŠ¡")
            print("  python scripts/task_evaluator.py -g      # æŸ¥çœ‹æŒ‡å—")
            print("  python scripts/task_evaluator.py -haiku  # äº†è§£Haiku")
        elif arg in ['-haiku', 'haiku']:
            explain_haiku()
        else:
            # å°†å‚æ•°ä½œä¸ºä»»åŠ¡æè¿°
            result = evaluate_task(arg)
    else:
        print("\né€‰æ‹©æ“ä½œ:")
        print("  1. è¯„ä¼°ä»»åŠ¡å¤æ‚åº¦ (æ¨è)")
        print("  2. æŸ¥çœ‹å¿«é€ŸæŒ‡å—")
        print("  3. äº†è§£ Haiku æ¨¡å‹")
        print("  q. é€€å‡º")
        
        choice = input("\nè¯·é€‰æ‹© (1/2/3/q): ").strip()
        
        if choice == '1':
            result = evaluate_task()
        elif choice == '2':
            quick_guide()
        elif choice == '3':
            explain_haiku()
        elif choice.lower() == 'q':
            print("å†è§!")
        else:
            # é»˜è®¤è¯„ä¼°
            result = evaluate_task()
