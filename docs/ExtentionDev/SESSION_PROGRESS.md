# TRQuant Cursor Extension å¼€å‘è¿›å±•è®°å½•

> **è‡ªåŠ¨æ›´æ–°**: æ¯æ¬¡å¼€å‘ä¼šè¯ç»“æŸæ—¶æ›´æ–°
> **ç›®çš„**: ä¿æŒå¼€å‘å»¶ç»­æ€§ï¼ŒChatè®°å½•å¯é‡è½½

---

## ğŸ“… å½“å‰ä¼šè¯ (2025-12-03)

### ä¼šè¯ç›®æ ‡
1. å®ç°æ ¸å¿ƒæŠ•èµ„æµç¨‹é—­ç¯ï¼šç”Ÿæˆä»£ç  â†’ å›æµ‹ â†’ åé¦ˆè¿­ä»£
2. å»ºç«‹è¿›å±•ä¿å­˜æœºåˆ¶
3. é›†æˆæ–‡ä»¶ç®¡ç†ç³»ç»Ÿï¼ˆå·²æœ‰dashboardï¼‰

### ç”¨æˆ·å…³é”®åé¦ˆ
1. **ä¾§è¾¹æ TreeView** - ç°çŠ¶å¤Ÿç”¨ï¼Œä¸éœ€è¦åœ¨é‡Œé¢æ”¾æŠ•èµ„æµç¨‹
2. **æ ¸å¿ƒç›®æ ‡** - ä¸“æ³¨ï¼šç”Ÿæˆä»£ç â†’å›æµ‹â†’åé¦ˆè¿­ä»£
3. **æ–‡ä»¶ç®¡ç†ç³»ç»Ÿ** - ä½¿ç”¨MongoDBï¼Œå‚è€ƒæ¡Œé¢è½¯ä»¶ï¼Œç‹¬ç«‹ç½‘é¡µç«¯
4. **çŸ¥è¯†åº“** - æ”¾åˆ°æœ€å
5. **è¿›å±•ä¿å­˜** - æ¯æ­¥è¿›å±•+Chatè®°å½•è¦èƒ½é‡è½½

### å·²ç¡®è®¤çš„ç°æœ‰èµ„æº

#### æ¡Œé¢è½¯ä»¶å·²æœ‰æ¨¡å—
```
gui/widgets/
â”œâ”€â”€ integrated_workflow_panel.py  # 8æ­¥éª¤å·¥ä½œæµ
â”œâ”€â”€ backtest_panel.py             # å›æµ‹é…ç½®
â”œâ”€â”€ data_manager_panel.py         # æ•°æ®ç®¡ç†ï¼ˆWebå…¥å£ï¼‰
â”œâ”€â”€ strategy_manager_panel.py     # ç­–ç•¥ç®¡ç†
â””â”€â”€ ...ï¼ˆ40+ä¸ªé¢æ¿ï¼‰

core/
â”œâ”€â”€ workflow_orchestrator.py      # å·¥ä½œæµç¼–æ’å™¨
â”œâ”€â”€ backtest_engine.py            # å›æµ‹å¼•æ“
â”œâ”€â”€ strategy_generator.py         # ç­–ç•¥ç”Ÿæˆ
â””â”€â”€ ...

dashboard/
â”œâ”€â”€ dashboard_server.py           # Flask Webä»ªè¡¨ç›˜
â”œâ”€â”€ astock_api.py                 # Aè‚¡ç­–ç•¥API
â””â”€â”€ templates/
    â””â”€â”€ dashboard.html            # ä»ªè¡¨ç›˜æ¨¡æ¿
```

#### å¯åŠ¨å‘½ä»¤
- **Webä»ªè¡¨ç›˜**: `python start_dashboard.py` (ç«¯å£5000)
- **Aè‚¡æ‰‹å†Œ**: `cd extension/AShare-manual && npm run dev` (ç«¯å£4321)

### ä»Šæ—¥å®Œæˆ
- [x] å›é¡¾æ‰€æœ‰è§„åˆ’æ–‡æ¡£
- [x] åˆ†ææ¡Œé¢è½¯ä»¶å·²æœ‰æ¨¡å—
- [x] åˆ›å»ºä¼˜åŒ–ä»»åŠ¡åˆ—è¡¨ (OPTIMIZED_TASK_LIST.md)
- [x] Aè‚¡å®æ“æ‰‹å†Œå¯åŠ¨åŠŸèƒ½ï¼ˆlaunchAShareManualï¼‰
- [x] ç†è§£ç”¨æˆ·ä¼˜å…ˆçº§è°ƒæ•´
- [x] åˆ›å»ºä¼šè¯è¿›å±•ä¿å­˜æ–‡ä»¶ (SESSION_PROGRESS.md)
- [x] æ·»åŠ æ–‡ä»¶ç®¡ç†ç³»ç»Ÿå¯åŠ¨åŠŸèƒ½ (launchFileDashboard)
- [x] **8æ­¥æŠ•èµ„æµç¨‹å®Œæ•´ä¼˜åŒ–**ï¼š
  - é‡å†™ `run_workflow_step` å‡½æ•°ï¼Œå®Œå…¨å¤ç”¨ `WorkflowOrchestrator`
  - æ­¥éª¤1-6: ç›´æ¥è°ƒç”¨æ¡Œé¢ç³»ç»Ÿçš„æ–¹æ³•
  - æ­¥éª¤7 `_run_backtest_step`: è¿æ¥å›æµ‹å¼•æ“ï¼Œä¿å­˜ç»“æœåˆ°MongoDB
  - æ­¥éª¤8 `_check_broker_step`: æ£€æµ‹PTrade/QMTè¿æ¥çŠ¶æ€
  - æ·»åŠ  `run_full_workflow` å‡½æ•°æ‰§è¡Œå®Œæ•´æµç¨‹
  - Mockæ•°æ®å®Œå–„ï¼Œæ ¼å¼ä¸æ¡Œé¢ç³»ç»Ÿä¸€è‡´

### 8æ­¥å·¥ä½œæµè¯¦æƒ…

| æ­¥éª¤ | ID | æ–¹æ³• | åŠŸèƒ½ |
|------|-----|------|------|
| 1 | data_source | check_data_sources | JQData/AKShare/MongoDBæ£€æµ‹ |
| 2 | market_trend | analyze_market_trend | å¤šå‘¨æœŸè¶‹åŠ¿åˆ†æï¼Œç”ŸæˆHTMLæŠ¥å‘Š |
| 3 | mainline | identify_mainlines | TOP20æŠ•èµ„ä¸»çº¿ï¼Œèµ„é‡‘æµå‘ |
| 4 | candidate_pool | build_candidate_pool | ä¸»çº¿ç­›é€‰+å¼ºåŠ¿è‚¡ |
| 5 | factor | recommend_factors | AI/è§„åˆ™å› å­æ¨è |
| 6 | strategy | generate_strategy | PTradeç­–ç•¥ä»£ç ç”Ÿæˆ |
| 7 | backtest | _run_backtest_step | æœ¬åœ°å›æµ‹éªŒè¯ |
| 8 | trading | _check_broker_step | åˆ¸å•†è¿æ¥çŠ¶æ€ |

### ç‹¬ç«‹Dashboardç³»ç»Ÿ

**é‡è¦è®¾è®¡å˜æ›´**ï¼šDashboardç°åœ¨å®Œå…¨ç‹¬ç«‹äºæ¡Œé¢ç³»ç»Ÿï¼Œä½äº `extension/` ç›®å½•å†…ã€‚

**ç›®å½•ç»“æ„**ï¼š
```
extension/
â”œâ”€â”€ dashboard/
â”‚   â”œâ”€â”€ server.py        # FlaskæœåŠ¡ï¼ˆ900+è¡Œå®Œæ•´åŠŸèƒ½ï¼‰
â”‚   â”œâ”€â”€ templates/
â”‚   â”‚   â”œâ”€â”€ dashboard.html  # ä¸»ç•Œé¢
â”‚   â”‚   â””â”€â”€ doc_viewer.html # æ–‡æ¡£æŸ¥çœ‹å™¨
â”‚   â””â”€â”€ __init__.py
â”œâ”€â”€ data/                # æ‰©å±•ä»¶æ•°æ®ç›®å½•
â”‚   â”œâ”€â”€ strategies/      # PTrade/QMT/ç¤ºä¾‹ç­–ç•¥
â”‚   â”œâ”€â”€ reports/         # å›æµ‹æŠ¥å‘Š
â”‚   â”œâ”€â”€ backtests/       # å›æµ‹ç»“æœJSON
â”‚   â”œâ”€â”€ docs/            # ç ”ç©¶æ–‡æ¡£
â”‚   â””â”€â”€ config/          # é…ç½®æ–‡ä»¶
â”œâ”€â”€ start_dashboard.py   # å¯åŠ¨è„šæœ¬
â””â”€â”€ requirements.txt     # Pythonä¾èµ–
```

**DashboardåŠŸèƒ½æ¨¡å—**ï¼š
| æ¨¡å— | API | åŠŸèƒ½ |
|------|-----|------|
| æ¦‚è§ˆ | `/api/overview` | ç­–ç•¥/æŠ¥å‘Š/å›æµ‹ç»Ÿè®¡ |
| ç­–ç•¥ç®¡ç† | `/api/strategies` | PTrade/QMT/ç¤ºä¾‹ç­–ç•¥åˆ—è¡¨ |
| æŠ¥å‘Šç®¡ç† | `/api/reports` | å›æµ‹æŠ¥å‘ŠæŸ¥çœ‹ |
| å›æµ‹è®°å½• | `/api/backtests` | å›æµ‹ç»“æœ+ç»Ÿè®¡ |
| æ–‡æ¡£ç®¡ç† | `/api/docs` | MDæ¸²æŸ“ã€åˆ†ç±»æµè§ˆ |
| æ•°æ®åº“ | `/api/database` | MongoDBé›†åˆç®¡ç†ã€å¯¼å‡º |
| å·¥ä½œæµ | `/api/workflow` | 8æ­¥æŠ•èµ„æµç¨‹æ•°æ® |

### è¿›è¡Œä¸­
- [ ] æµ‹è¯•å®Œæ•´æ–‡ä»¶ç®¡ç†ç³»ç»ŸåŠŸèƒ½

### å¾…åŠ
- [ ] MCPå·¥å…·æ‰©å±•ï¼ˆ7ä¸ªæ–°å·¥å…·ï¼‰
- [ ] å›æµ‹ç»“æœä¸QuantConnectæŠ¥å‘Šå¯¹æ¥
- [ ] çŸ¥è¯†åº“ï¼ˆæœ€åï¼‰

---

## ğŸ”§ æŠ€æœ¯å†³ç­–è®°å½•

### æ–‡ä»¶ç®¡ç†ç³»ç»Ÿ
- **æ–¹æ¡ˆ**: å¤ç”¨ç°æœ‰ `dashboard/` FlaskæœåŠ¡
- **æ•°æ®åº“**: MongoDB
- **è®¿é—®æ–¹å¼**: æµè§ˆå™¨æ‰“å¼€ http://localhost:5000
- **ä»æ‰©å±•å¯åŠ¨**: ç±»ä¼¼Aè‚¡æ‰‹å†Œçš„ç»ˆç«¯å¯åŠ¨æ–¹å¼

### æ ¸å¿ƒæŠ•èµ„æµç¨‹
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  1. ç­–ç•¥ç”Ÿæˆ (generate_strategy)                  â”‚
â”‚     â†“                                            â”‚
â”‚  2. å›æµ‹éªŒè¯ (run_backtest)                       â”‚
â”‚     â†“                                            â”‚
â”‚  3. ç»“æœåˆ†æ (analyze_backtest)                   â”‚
â”‚     â†“                                            â”‚
â”‚  4. AIåé¦ˆ (suggest_improvements) - MCPå·¥å…·      â”‚
â”‚     â†“                                            â”‚
â”‚  5. ä»£ç è¿­ä»£ (ä¿®æ”¹ç­–ç•¥åé‡å¤)                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“ Chatè®°å½•æ‘˜è¦

### å…³é”®å¯¹è¯ç‚¹

**ç”¨æˆ·**: "ä¾§è¾¹æ ç°åœ¨çŠ¶æ€å·²ç»æš‚æ—¶å¤Ÿç”¨äº†ï¼Œé‡Œé¢ä¸éœ€è¦æœ‰å…¶å®ƒæŠ•èµ„æµç¨‹"
**ç†è§£**: TreeViewä¿æŒç°çŠ¶ï¼Œä¸“æ³¨æ ¸å¿ƒåŠŸèƒ½

**ç”¨æˆ·**: "æ–‡ä»¶ç®¡ç†ç³»ç»Ÿå¾ˆé‡è¦...ç”±æ•°æ®åº“æ¥ç®¡ç†ï¼ˆmongodbï¼‰...ç‹¬ç«‹ç½‘é¡µç«¯"
**ç†è§£**: å¤ç”¨dashboardï¼ŒMongoDBå­˜å‚¨

**ç”¨æˆ·**: "æ¯ä¸€æ­¥çš„è¿›å±•ï¼Œè¿˜æœ‰chatçš„è®°å½•éƒ½è¦ä¿å­˜"
**ç†è§£**: éœ€è¦SESSION_PROGRESS.mdè¿™æ ·çš„æ–‡ä»¶

---

## ğŸ”„ ä¸‹æ¬¡ä¼šè¯æ¢å¤æŒ‡å—

å¦‚æœå¼€å§‹æ–°çš„èŠå¤©çª—å£ï¼Œè¯·å‘Šè¯‰AIï¼š

```
è¯·æŸ¥çœ‹ä»¥ä¸‹æ–‡ä»¶äº†è§£å½“å‰å¼€å‘çŠ¶æ€ï¼š
1. /home/taotao/dev/QuantTest/TRQuant/docs/ExtentionDev/SESSION_PROGRESS.md - ä¼šè¯è¿›å±•
2. /home/taotao/dev/QuantTest/TRQuant/docs/ExtentionDev/OPTIMIZED_TASK_LIST.md - ä»»åŠ¡åˆ—è¡¨

ç»§ç»­æœªå®Œæˆçš„ä»»åŠ¡ï¼Œä¼˜å…ˆçº§ï¼š
P0: æ ¸å¿ƒæŠ•èµ„æµç¨‹ï¼ˆç”Ÿæˆä»£ç â†’å›æµ‹â†’è¿­ä»£ï¼‰
P1: æ–‡ä»¶ç®¡ç†ç³»ç»Ÿï¼ˆå¤ç”¨dashboardï¼‰
P2: MCPå·¥å…·æ‰©å±•
P3: çŸ¥è¯†åº“ï¼ˆæœ€åï¼‰
```

---

*æœ€åæ›´æ–°: 2025-12-03*

