---
title: "4.2 毛利率因子"
description: "毛利率因子的构建方法、经济学逻辑和A股应用"
lang: "zh-CN"
layout: "/src/layouts/Layout.astro"
currentBook: "ashare-quantitative"
currentChapter: "ashare-quantitative-chapter4"
updateDate: "2025-01-26"
---

# 💰 4.2 毛利率因子

> **核心摘要：**
> 
> 毛利率是衡量公司产品定价能力和成本控制能力的核心指标。本节介绍毛利率因子的计算方法、经济学逻辑、A股有效性验证和策略应用。

## 📋 章节概览

<div class="section-overview">
  <div class="overview-item">
    <span class="item-icon">📊</span>
    <a href="#definition">因子定义</a>
    <span class="item-desc">毛利率的计算方法</span>
  </div>
  <div class="overview-item">
    <span class="item-icon">💡</span>
    <a href="#logic">经济学逻辑</a>
    <span class="item-desc">高毛利率的竞争优势</span>
  </div>
  <div class="overview-item">
    <span class="item-icon">📈</span>
    <a href="#ashare">A股验证</a>
    <span class="item-desc">毛利率因子有效性</span>
  </div>
  <div class="overview-item">
    <span class="item-icon">🖥️</span>
    <a href="#implementation">策略实现</a>
    <span class="item-desc">韬睿平台因子计算</span>
  </div>
</div>

---

<h2 id="definition">📊 因子定义</h2>

### 毛利率计算方法

<div class="comparison-table">
  <table>
    <thead>
      <tr>
        <th>指标</th>
        <th>计算公式</th>
        <th>含义</th>
        <th>适用场景</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td><strong>毛利率</strong></td>
        <td>(营收 - 营业成本) / 营收</td>
        <td>产品盈利能力</td>
        <td>最常用</td>
      </tr>
      <tr>
        <td><strong>毛利率变化</strong></td>
        <td>本期毛利率 - 去年同期</td>
        <td>盈利能力改善</td>
        <td>动态分析</td>
      </tr>
      <tr>
        <td><strong>行业相对毛利率</strong></td>
        <td>公司毛利率 - 行业中位数</td>
        <td>相对竞争优势</td>
        <td>跨行业比较</td>
      </tr>
    </tbody>
  </table>
</div>

---

<h2 id="logic">💡 经济学逻辑</h2>

### 高毛利率的竞争优势

<div class="exchange-grid">
  <div class="exchange-card">
    <div class="exchange-header">
      <span class="exchange-icon">🏆</span>
      <h3>定价能力</h3>
    </div>
    <div class="exchange-content">
      <p><strong>含义：</strong>高毛利率反映强定价能力</p>
      <p><strong>来源：</strong>品牌、技术、垄断</p>
      <p><strong>案例：</strong>茅台毛利率>90%</p>
      <p><strong>参考：</strong>第一册5.2节盈利能力</p>
    </div>
  </div>

  <div class="exchange-card">
    <div class="exchange-header">
      <span class="exchange-icon">🛡️</span>
      <h3>竞争壁垒</h3>
    </div>
    <div class="exchange-content">
      <p><strong>含义：</strong>高毛利率体现护城河</p>
      <p><strong>类型：</strong>技术壁垒、品牌壁垒</p>
      <p><strong>持续性：</strong>壁垒越深越持久</p>
      <p><strong>参考：</strong>第一册3.4节竞争优势</p>
    </div>
  </div>

  <div class="exchange-card">
    <div class="exchange-header">
      <span class="exchange-icon">📈</span>
      <h3>盈利弹性</h3>
    </div>
    <div class="exchange-content">
      <p><strong>含义：</strong>高毛利率带来经营杠杆</p>
      <p><strong>效果：</strong>营收增长放大利润增长</p>
      <p><strong>风险：</strong>下滑时利润下降更快</p>
    </div>
  </div>
</div>

### 毛利率的行业差异

<div class="comparison-table">
  <table>
    <thead>
      <tr>
        <th>行业</th>
        <th>典型毛利率</th>
        <th>驱动因素</th>
        <th>代表公司</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td><strong>白酒</strong></td>
        <td>70-95%</td>
        <td>品牌溢价</td>
        <td>茅台、五粮液</td>
      </tr>
      <tr>
        <td><strong>软件</strong></td>
        <td>60-80%</td>
        <td>边际成本低</td>
        <td>金山办公、用友</td>
      </tr>
      <tr>
        <td><strong>医药</strong></td>
        <td>50-80%</td>
        <td>研发壁垒</td>
        <td>恒瑞、药明康德</td>
      </tr>
      <tr>
        <td><strong>消费电子</strong></td>
        <td>15-30%</td>
        <td>规模效应</td>
        <td>立讯、歌尔</td>
      </tr>
      <tr>
        <td><strong>零售</strong></td>
        <td>15-25%</td>
        <td>周转效率</td>
        <td>永辉、苏宁</td>
      </tr>
    </tbody>
  </table>
</div>

---

<h2 id="ashare">📈 A股验证</h2>

### 毛利率因子回测结果

<div class="comparison-table">
  <table>
    <thead>
      <tr>
        <th>因子</th>
        <th>IC均值</th>
        <th>IC_IR</th>
        <th>多空收益</th>
        <th>有效性</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td><strong>毛利率（行业中性）</strong></td>
        <td>0.028</td>
        <td>0.38</td>
        <td>10.5%/年</td>
        <td>⭐⭐⭐⭐</td>
      </tr>
      <tr>
        <td><strong>毛利率变化</strong></td>
        <td>0.035</td>
        <td>0.48</td>
        <td>12.8%/年</td>
        <td>⭐⭐⭐⭐⭐</td>
      </tr>
      <tr>
        <td><strong>毛利率稳定性</strong></td>
        <td>0.022</td>
        <td>0.32</td>
        <td>8.5%/年</td>
        <td>⭐⭐⭐⭐</td>
      </tr>
    </tbody>
  </table>
</div>

<div class="tip-box">
  <h4>💡 A股毛利率因子特点</h4>
  <ul>
    <li><strong>必须行业中性化：</strong>行业间毛利率差异大，需中性化处理</li>
    <li><strong>变化更有效：</strong>毛利率改善比绝对值更有预测力</li>
    <li><strong>稳定性重要：</strong>毛利率稳定的公司更受青睐</li>
    <li><strong>结合ROE：</strong>高毛利率+高ROE效果最佳</li>
  </ul>
</div>

---

<h2 id="implementation">🖥️ 策略实现</h2>

### 韬睿平台毛利率因子计算

<div class="board-details">
  <div class="board-card">
    <h4>📊 毛利率因子计算代码</h4>
    <div class="board-content">

```python
def calc_gross_margin(stocks, date):
    """
    计算毛利率因子
    """
    df = get_fundamentals(query(
        valuation.code,
        indicator.gross_profit_margin
    ).filter(valuation.code.in_(stocks)), date=date)
    
    return df[['code', 'gross_profit_margin']]

def calc_gross_margin_change(stocks, date):
    """
    计算毛利率变化因子
    """
    # 当前毛利率
    current = calc_gross_margin(stocks, date)
    
    # 去年同期毛利率
    last_year = date - pd.DateOffset(years=1)
    previous = calc_gross_margin(stocks, last_year)
    
    # 计算变化
    df = current.merge(previous, on='code', suffixes=('_current', '_prev'))
    df['margin_change'] = df['gross_profit_margin_current'] - df['gross_profit_margin_prev']
    
    return df[['code', 'margin_change']]

def high_margin_strategy(date, hold_num=30):
    """
    高毛利率策略
    
    筛选条件：
    1. 毛利率 > 行业中位数
    2. 毛利率同比提升
    3. ROE > 15%
    """
    stocks = get_index_stocks('000300.XSHG', date)
    
    df = get_fundamentals(query(
        valuation.code,
        indicator.gross_profit_margin,
        indicator.roe
    ).filter(
        valuation.code.in_(stocks),
        indicator.roe > 15
    ), date=date)
    
    # 计算毛利率变化
    margin_change = calc_gross_margin_change(stocks, date)
    df = df.merge(margin_change[['code', 'margin_change']], on='code')
    
    # 筛选毛利率提升的股票
    df = df[df['margin_change'] > 0]
    
    # 按毛利率排序
    df = df.sort_values('gross_profit_margin', ascending=False)
    
    return df.head(hold_num)['code'].tolist()
```

</div>
  </div>
</div>

## 💎 核心要点总结

<div class="key-points">
  <div class="key-point">
    <h4>🏆 定价能力</h4>
    <p>高毛利率反映强定价能力和竞争壁垒</p>
  </div>
  <div class="key-point">
    <h4>📊 行业中性化</h4>
    <p>行业间差异大，必须行业中性化</p>
  </div>
  <div class="key-point">
    <h4>📈 变化更有效</h4>
    <p>毛利率改善比绝对值更有预测力</p>
  </div>
  <div class="key-point">
    <h4>🔗 结合ROE</h4>
    <p>高毛利率+高ROE效果最佳</p>
  </div>
</div>

## 🔮 总结与展望

<div class="summary-outlook">
  <h3>本节回顾</h3>
  <p>本节介绍了毛利率因子的计算方法、经济学逻辑、A股有效性验证和策略实现。毛利率是衡量公司竞争优势的核心指标。</p>
  
  <h3>下节预告</h3>
  <p>下一节将学习资产周转率因子，关注公司的运营效率。</p>
  
  <a href="/ashare-book4/004_Chapter4/4.3_Turnover_Factor_CN" class="next-section">
    继续学习：4.3 资产周转率因子 →
  </a>
</div>
