---
title: "4.6 è´¨é‡å› å­ç»„åˆ"
description: "å­¦ä¹ å¦‚ä½•ç»„åˆå¤šä¸ªè´¨é‡å› å­ï¼Œæ„å»ºå¤åˆè´¨é‡å› å­"
lang: "zh-CN"
layout: "/src/layouts/Layout.astro"
currentBook: "ashare-quantitative"
currentChapter: "ashare-quantitative-chapter4"
updateDate: "2025-01-26"
---

# ğŸ”— 4.6 è´¨é‡å› å­ç»„åˆ

> **æ ¸å¿ƒæ‘˜è¦ï¼š**
> 
> å•ä¸€è´¨é‡å› å­å„æœ‰ä¾§é‡ï¼Œé€šè¿‡ç»„åˆå¤šä¸ªè´¨é‡å› å­å¯ä»¥æ›´å…¨é¢åœ°è¯„ä¼°å…¬å¸è´¨é‡ã€‚æœ¬èŠ‚è®²è§£è´¨é‡å› å­çš„ç»„åˆæ–¹æ³•å’Œå›æµ‹éªŒè¯ã€‚

## ğŸ“‹ ç« èŠ‚æ¦‚è§ˆ

<div class="section-overview">
  <div class="overview-item">
    <span class="item-icon">ğŸ”„</span>
    <a href="#methods">å› å­ç»„åˆæ–¹æ³•</a>
    <span class="item-desc">è´¨é‡å› å­çš„ç»„åˆç­–ç•¥</span>
  </div>
  <div class="overview-item">
    <span class="item-icon">ğŸ“Š</span>
    <a href="#implementation">å¤åˆå› å­æ„å»º</a>
    <span class="item-desc">å¤åˆè´¨é‡å› å­çš„å®ç°</span>
  </div>
  <div class="overview-item">
    <span class="item-icon">ğŸ“ˆ</span>
    <a href="#backtest">å›æµ‹éªŒè¯</a>
    <span class="item-desc">å¤åˆå› å­æ•ˆæœéªŒè¯</span>
  </div>
  <div class="overview-item">
    <span class="item-icon">ğŸ–¥ï¸</span>
    <a href="#strategy">ç­–ç•¥åº”ç”¨</a>
    <span class="item-desc">éŸ¬ç¿å¹³å°è´¨é‡ç­–ç•¥</span>
  </div>
</div>

---

<h2 id="methods">ğŸ”„ å› å­ç»„åˆæ–¹æ³•</h2>

### è´¨é‡å› å­ç»„åˆç­–ç•¥

<div class="comparison-table">
  <table>
    <thead>
      <tr>
        <th>ç»„åˆç»´åº¦</th>
        <th>åŒ…å«å› å­</th>
        <th>æƒé‡å»ºè®®</th>
        <th>è¯´æ˜</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td><strong>ç›ˆåˆ©èƒ½åŠ›</strong></td>
        <td>ROEã€æ¯›åˆ©ç‡ã€å‡€åˆ©ç‡</td>
        <td>40%</td>
        <td>æ ¸å¿ƒè´¨é‡ç»´åº¦</td>
      </tr>
      <tr>
        <td><strong>è¿è¥æ•ˆç‡</strong></td>
        <td>èµ„äº§å‘¨è½¬ç‡ã€å­˜è´§å‘¨è½¬ç‡</td>
        <td>20%</td>
        <td>èµ„äº§åˆ©ç”¨æ•ˆç‡</td>
      </tr>
      <tr>
        <td><strong>è´¢åŠ¡ç¨³å¥</strong></td>
        <td>èµ„äº§è´Ÿå€ºç‡ã€åˆ©æ¯ä¿éšœ</td>
        <td>20%</td>
        <td>è´¢åŠ¡é£é™©æ§åˆ¶</td>
      </tr>
      <tr>
        <td><strong>ç›ˆåˆ©ç¨³å®š</strong></td>
        <td>ROEç¨³å®šæ€§ã€åˆ©æ¶¦æ³¢åŠ¨</td>
        <td>20%</td>
        <td>ç›ˆåˆ©å¯é¢„æµ‹æ€§</td>
      </tr>
    </tbody>
  </table>
</div>

### è´¨é‡å­å› å­ç›¸å…³æ€§

<div class="comparison-table">
  <table>
    <thead>
      <tr>
        <th>å› å­å¯¹</th>
        <th>ç›¸å…³ç³»æ•°</th>
        <th>ç»„åˆæ•ˆæœ</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td>ROE vs æ¯›åˆ©ç‡</td>
        <td>0.55</td>
        <td>ä¸­ç­‰äº’è¡¥</td>
      </tr>
      <tr>
        <td>ROE vs èµ„äº§è´Ÿå€ºç‡</td>
        <td>0.25</td>
        <td>è‰¯å¥½äº’è¡¥</td>
      </tr>
      <tr>
        <td>æ¯›åˆ©ç‡ vs å‘¨è½¬ç‡</td>
        <td>-0.35</td>
        <td>è´Ÿç›¸å…³ï¼Œäº’è¡¥æ€§å¼º</td>
      </tr>
      <tr>
        <td>ROE vs ROEç¨³å®šæ€§</td>
        <td>0.40</td>
        <td>è¾ƒå¥½äº’è¡¥</td>
      </tr>
    </tbody>
  </table>
</div>

---

<h2 id="implementation">ğŸ“Š å¤åˆå› å­æ„å»º</h2>

### å¤åˆè´¨é‡å› å­æ„å»ºä»£ç 

```python
import pandas as pd
import numpy as np
from jqdata import *

def build_composite_quality_factor(stocks, date, method='weighted'):
    """
    æ„å»ºå¤åˆè´¨é‡å› å­
    
    å‚æ•°:
        stocks: è‚¡ç¥¨åˆ—è¡¨
        date: è®¡ç®—æ—¥æœŸ
        method: ç»„åˆæ–¹æ³• ('equal', 'weighted')
    
    è¿”å›:
        å¤åˆè´¨é‡å› å­Series
    """
    # 1. è®¡ç®—å„å­å› å­
    roe = calculate_roe(stocks, date)
    gross_margin = calculate_gross_margin(stocks, date)
    leverage = -calculate_leverage(stocks, date)  # ä½æ æ†ä¸ºæ­£
    turnover = calculate_asset_turnover(stocks, date)
    roe_stability = calculate_roe_stability(stocks, date)
    
    # 2. è¡Œä¸šä¸­æ€§åŒ–
    roe_neutral = industry_neutralize(roe, stocks, date)
    margin_neutral = industry_neutralize(gross_margin, stocks, date)
    leverage_neutral = industry_neutralize(leverage, stocks, date)
    turnover_neutral = industry_neutralize(turnover, stocks, date)
    stability_neutral = industry_neutralize(roe_stability, stocks, date)
    
    # 3. ç»„åˆ
    if method == 'equal':
        composite = (roe_neutral + margin_neutral + leverage_neutral + 
                     turnover_neutral + stability_neutral) / 5
    else:
        # åŠ æƒç»„åˆ
        composite = (
            roe_neutral * 0.30 + 
            margin_neutral * 0.25 + 
            leverage_neutral * 0.15 + 
            turnover_neutral * 0.15 +
            stability_neutral * 0.15
        )
    
    # 4. æœ€ç»ˆæ ‡å‡†åŒ–
    composite = (composite - composite.mean()) / composite.std()
    
    return composite
```

### ROEç¨³å®šæ€§è®¡ç®—

```python
def calculate_roe_stability(stocks, date, lookback_years=3):
    """
    è®¡ç®—ROEç¨³å®šæ€§ï¼ˆROEæ³¢åŠ¨ç‡çš„å€’æ•°ï¼‰
    
    å‚æ•°:
        stocks: è‚¡ç¥¨åˆ—è¡¨
        date: è®¡ç®—æ—¥æœŸ
        lookback_years: å›æº¯å¹´æ•°
    
    è¿”å›:
        ROEç¨³å®šæ€§Seriesï¼ˆæ³¢åŠ¨ç‡è¶Šä½ï¼Œç¨³å®šæ€§è¶Šé«˜ï¼‰
    """
    roe_history = []
    
    for year_offset in range(lookback_years):
        hist_date = date.replace(year=date.year - year_offset)
        q = query(indicator.code, indicator.roe).filter(
            indicator.code.in_(stocks)
        )
        roe = get_fundamentals(q, hist_date)
        roe_history.append(roe.set_index('code')['roe'])
    
    roe_df = pd.DataFrame(roe_history).T
    
    # è®¡ç®—æ³¢åŠ¨ç‡
    roe_std = roe_df.std(axis=1)
    
    # ç¨³å®šæ€§ = 1 / æ³¢åŠ¨ç‡ï¼ˆæ³¢åŠ¨ç‡è¶Šä½ï¼Œç¨³å®šæ€§è¶Šé«˜ï¼‰
    stability = 1 / (roe_std + 0.01)  # åŠ å°æ•°é¿å…é™¤é›¶
    
    return stability
```

---

<h2 id="backtest">ğŸ“ˆ å›æµ‹éªŒè¯</h2>

### å¤åˆå› å­å›æµ‹ç»“æœ

<div class="comparison-table">
  <table>
    <thead>
      <tr>
        <th>å› å­</th>
        <th>ICå‡å€¼</th>
        <th>IC_IR</th>
        <th>å¹´åŒ–å¤šç©ºæ”¶ç›Š</th>
        <th>å¤æ™®æ¯”ç‡</th>
        <th>æœ€å¤§å›æ’¤</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td><strong>ROEå•å› å­</strong></td>
        <td>0.032</td>
        <td>0.48</td>
        <td>7.2%</td>
        <td>0.58</td>
        <td>22%</td>
      </tr>
      <tr>
        <td><strong>æ¯›åˆ©ç‡å•å› å­</strong></td>
        <td>0.028</td>
        <td>0.42</td>
        <td>6.8%</td>
        <td>0.55</td>
        <td>20%</td>
      </tr>
      <tr>
        <td><strong>ç­‰æƒå¤åˆå› å­</strong></td>
        <td>0.038</td>
        <td>0.55</td>
        <td>8.8%</td>
        <td>0.68</td>
        <td>18%</td>
      </tr>
      <tr>
        <td><strong>åŠ æƒå¤åˆå› å­</strong></td>
        <td>0.042</td>
        <td>0.62</td>
        <td>9.5%</td>
        <td>0.75</td>
        <td>16%</td>
      </tr>
    </tbody>
  </table>
</div>

### å¤åˆå› å­çš„ä¼˜åŠ¿

<div class="tip-box">
  <h4>ğŸ“Š å¤åˆå› å­æ•ˆæœæå‡åŸå› </h4>
  <ul>
    <li><strong>ICæå‡ï¼š</strong>å¤åˆå› å­ICï¼ˆ0.038-0.042ï¼‰é«˜äºä»»ä½•å•ä¸€å› å­</li>
    <li><strong>ç¨³å®šæ€§æå‡ï¼š</strong>IC_IRä»0.42-0.48æå‡åˆ°0.55-0.62</li>
    <li><strong>å›æ’¤é™ä½ï¼š</strong>æœ€å¤§å›æ’¤ä»20-22%é™ä½åˆ°16-18%</li>
    <li><strong>å¤æ™®æå‡ï¼š</strong>å¤æ™®æ¯”ç‡ä»0.55-0.58æå‡åˆ°0.68-0.75</li>
  </ul>
</div>

---

<h2 id="strategy">ğŸ–¥ï¸ ç­–ç•¥åº”ç”¨</h2>

### éŸ¬ç¿å¹³å°å¤åˆè´¨é‡ç­–ç•¥

```python
def taorui_composite_quality_strategy(context):
    """
    éŸ¬ç¿å¹³å°å¤åˆè´¨é‡ç­–ç•¥
    
    ç­–ç•¥é€»è¾‘ï¼š
    1. è®¡ç®—å¤åˆè´¨é‡å› å­
    2. ç»“åˆä¼°å€¼ç­›é€‰ï¼ˆé¿å…é«˜ä¼°å€¼é™·é˜±ï¼‰
    3. é€‰æ‹©å› å­å€¼æœ€é«˜çš„30åª
    4. ç­‰æƒæŒæœ‰ï¼Œæœˆåº¦è°ƒä»“
    """
    # è·å–è‚¡ç¥¨æ± 
    stocks = get_index_stocks('000905.XSHG', context.current_dt)
    
    # è®¡ç®—å¤åˆè´¨é‡å› å­
    composite_quality = build_composite_quality_factor(
        stocks, 
        context.current_dt, 
        method='weighted'
    )
    
    # ä¼°å€¼ç­›é€‰ï¼šPE < 50ï¼Œé¿å…é«˜ä¼°å€¼é™·é˜±
    valuation = get_valuation(stocks, context.current_dt, fields=['pe_ratio'])
    reasonable_pe = valuation[valuation['pe_ratio'] < 50].index
    
    qualified = composite_quality[composite_quality.index.isin(reasonable_pe)]
    
    # é€‰æ‹©å› å­å€¼æœ€é«˜çš„30åª
    top_stocks = qualified.nlargest(30).index.tolist()
    
    # ç­‰æƒè°ƒä»“
    rebalance_portfolio(context, top_stocks)
```

### è´¨é‡+æˆé•¿ç»„åˆç­–ç•¥

```python
def quality_growth_combo_strategy(context):
    """
    è´¨é‡+æˆé•¿ç»„åˆç­–ç•¥ï¼ˆGARPç­–ç•¥ï¼‰
    
    ç­–ç•¥é€»è¾‘ï¼š
    1. è®¡ç®—å¤åˆè´¨é‡å› å­å’Œå¤åˆæˆé•¿å› å­
    2. ç»¼åˆè¯„åˆ†é€‰è‚¡
    3. ç”¨PEGè¿›è¡Œä¼°å€¼è¿‡æ»¤
    """
    stocks = get_index_stocks('000905.XSHG', context.current_dt)
    
    # è®¡ç®—å› å­
    quality_factor = build_composite_quality_factor(stocks, context.current_dt)
    growth_factor = build_composite_growth_factor(stocks, context.current_dt)
    
    # ç»¼åˆå› å­ï¼ˆè´¨é‡60%ï¼Œæˆé•¿40%ï¼‰
    combined = quality_factor * 0.6 + growth_factor * 0.4
    
    # PEGç­›é€‰
    peg = calculate_peg(stocks, context.current_dt)
    reasonable_peg = peg[(peg > 0) & (peg < 2)].index
    
    qualified = combined[combined.index.isin(reasonable_peg)]
    
    # é€‰è‚¡
    top_stocks = qualified.nlargest(30).index.tolist()
    rebalance_portfolio(context, top_stocks)
```

---

## ğŸ’ æ ¸å¿ƒè¦ç‚¹æ€»ç»“

<div class="key-points">
  <div class="key-point">
    <h4>ğŸ”„ ç»„åˆä¼˜äºå•ä¸€</h4>
    <p>å¤åˆè´¨é‡å› å­æ•ˆæœæ˜¾è‘—ä¼˜äºå•ä¸€å› å­</p>
  </div>
  <div class="key-point">
    <h4>âš–ï¸ å¤šç»´åº¦è¯„ä¼°</h4>
    <p>ä»ç›ˆåˆ©ã€æ•ˆç‡ã€ç¨³å¥ã€ç¨³å®šå››ä¸ªç»´åº¦è¯„ä¼°è´¨é‡</p>
  </div>
  <div class="key-point">
    <h4>ğŸ“Š ROEæƒé‡æœ€é«˜</h4>
    <p>ROEæ˜¯æ ¸å¿ƒè´¨é‡æŒ‡æ ‡ï¼Œå»ºè®®ç»™äºˆè¾ƒé«˜æƒé‡</p>
  </div>
  <div class="key-point">
    <h4>ğŸ”— ä¸æˆé•¿å› å­äº’è¡¥</h4>
    <p>è´¨é‡+æˆé•¿ç»„åˆï¼ˆGARPï¼‰æ˜¯ç»å…¸ç­–ç•¥</p>
  </div>
</div>

---

## ğŸ”® æ€»ç»“ä¸å±•æœ›

<div class="summary-outlook">
  <h3>æœ¬ç« å›é¡¾</h3>
  <p>æœ¬ç« ç³»ç»Ÿè®²è§£äº†è´¨é‡å› å­çš„ç†è®ºåŸºç¡€ã€æ¯›åˆ©ç‡ã€å‘¨è½¬ç‡ã€æ æ†ã€ç°é‡‘æµç­‰å› å­çš„æ„å»ºæ–¹æ³•ï¼Œä»¥åŠå¤åˆè´¨é‡å› å­çš„ç»„åˆç­–ç•¥ã€‚è´¨é‡å› å­åœ¨Aè‚¡é•¿æœŸæœ‰æ•ˆï¼Œå°¤å…¶åœ¨æ ¸å¿ƒèµ„äº§æ—¶ä»£è¡¨ç°çªå‡ºã€‚</p>
  
  <h3>ä¸‹ç« é¢„å‘Š</h3>
  <p>ä¸‹ä¸€ç« å°†å­¦ä¹ åŠ¨é‡å› å­ï¼ŒåŒ…æ‹¬ä»·æ ¼åŠ¨é‡ã€åè½¬å› å­ã€è¡Œä¸šåŠ¨é‡ç­‰å› å­çš„æ„å»ºæ–¹æ³•å’ŒAè‚¡åº”ç”¨ã€‚åŠ¨é‡å› å­æ˜¯æŠ€æœ¯é¢å› å­çš„ä»£è¡¨ï¼Œåœ¨Aè‚¡æœ‰ç‹¬ç‰¹çš„è¡¨ç°ã€‚</p>
  
  <a href="/ashare-book4/005_Chapter5_Momentum_Factors_CN" class="next-section">
    ç»§ç»­å­¦ä¹ ï¼šç¬¬äº”ç«  åŠ¨é‡å› å­æ„å»º â†’
  </a>
</div>
